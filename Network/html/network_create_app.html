<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>Creating a Network Application</title>
<title>Network Component: Creating a Network Application</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="drv.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="printComponentTabs.js"></script>
<script type="text/javascript" src="URL_keys.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="stylsheetf" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 46px;">
  <td id="projectlogo"><img alt="Logo" src="keilarm.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">Network Component
   &#160;<span id="projectnumber">Version 7.15.0</span>
   </div>
   <div id="projectbrief">MDK Middleware for IPv4 and IPv6 Networking</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<div id="DRVnav" class="tabs1">
    <ul class="tablist">
      <script type="text/javascript">
		<!--
		writeComponentTabs.call(this);
		//-->
      </script>
	  </ul>
</div>
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Usage&#160;and&#160;Description</span></a></li>
      <li><a href="modules.html"><span>Reference</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('network_create_app.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Creating a Network Application </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>The steps to create a microcontroller application that uses TCP/IP communication are:</p>
<ol type="1">
<li>Select <a class="el" href="network_create_app.html#nw_RTE_Software_Component_Selection">RTE Components</a> along with the Network Services that are required for your application.</li>
<li><a class="el" href="network_create_app.html#nw_Driver_Configuration">Enable the Network Driver and Controller</a> that is integrated in the microcontroller.</li>
<li>Configure the various <a class="el" href="network_create_app.html#nw_Device_Configuration">Network Components</a>.</li>
<li>Configure the <a class="el" href="network_create_app.html#nw_system_resources">system resources</a> according to the network component's <a class="el" href="nw_resource_requirements.html">Resource Requirements</a>.</li>
<li>Implement the <a class="el" href="network_create_app.html#nw_User_Code_Implementation">User Code</a> using code templates that are provided for the Network Component.</li>
<li><a class="el" href="network_create_app.html#nw_debugging">Debug</a> your application using the built-in mechanisms of the Network Component.</li>
<li>Sometimes, it is necessary to change some network settings at <a class="el" href="network_create_app.html#nw_runtime_config">runtime</a>.</li>
</ol>
<h1><a class="anchor" id="nw_RTE_Software_Component_Selection"></a>
RTE Component Selection</h1>
<p>Only a few steps are necessary to complete the RTE Component selection:</p>
<ol type="1">
<li>From the <b>Network</b> Component:<ul>
<li>Select <b>Network:CORE</b> that provides the basic functionality required for TCP/IP communication. Note that users of MDK-Professional can select between an IPv4/IPv6 dual-stack and an IPv4-only implementation, while users of MDK-Plus can only select the IPv4 implementation.</li>
<li>Select your desired <b>Network:Interface</b>. For example, set <b>Network:Interface:Ethernet</b> to '1' for enabling Ethernet communication.</li>
<li>Select the desired Network Services. For example, select <b>Network:Service:Web Server Compact</b> to create a simple Web Server.</li>
<li>Select the desired Network Sockets. For example, select <b>Network:Socket:TCP</b> for TCP communication. Usually, you will also select <b>Network:Socket:UDP</b> for stateless communication.</li>
</ul>
</li>
<li>From the <b>CMSIS Driver</b> Component:<ul>
<li>If you do Ethernet communication, select appropriate <b>CMSIS Driver:Ethernet (API)</b> or <b>CMSIS Driver:Ethernet MAC (API)</b> <em>and</em> <b>CMSIS Driver:Ethernet PHY (API)</b> drivers suitable for your application. For PPP or SLIP communication simply select <b>CMSIS Driver:USART (API):USART</b>. If you use wireless communication, select appropriate <b>CMSIS Driver:WiFi (API)</b> driver that supports transparent mode.</li>
</ul>
</li>
<li>From the <b>Device</b> Component:<ul>
<li>Additional device specific drivers may be required according to the validation output.</li>
</ul>
</li>
<li>From the <b>CMSIS</b> Component:<ul>
<li>Select the <b>CMSIS:CORE</b> to provide the core interface to the processor.</li>
<li>Select a suitable <b>CMSIS:RTOS</b> or <b>CMSIS:RTOS2</b> that is required for the Networking Component.</li>
</ul>
</li>
<li>If you need to <a class="el" href="secure_communication.html">secure the communication</a>, select from the <b>Security</b> Component:<ul>
<li><b>mbed</b> <b>TLS</b> </li>
</ul>
</li>
</ol>
<div class="image">
<img src="nw_rte_comp_selection.png" alt="nw_rte_comp_selection.png"/>
<div class="caption">
RTE Component Selection Example</div></div>
 <h1><a class="anchor" id="nw_Driver_Configuration"></a>
Network Driver and Controller Configuration</h1>
<p>The Network Device Driver and the Network Controller of the microcontroller need to be correctly configured. This means:</p>
<ul>
<li>The <a class="el" href="group__net_e_t_h___func.html">Ethernet interface</a> or <b>UART</b> (for <a class="el" href="group__net_s_l_i_p___func.html">SLIP</a>/<a class="el" href="group__net_p_p_p___func.html">PPP</a>) is typically configured in the <b>RTE_Device.h</b> configuration file. While this file provides multiple options, it is typically sufficient to enable the Ethernet/UART interface. <b>Note:</b> Some microcontrollers may require settings that are related to a physical layer interface (PHY).</li>
<li>The Network Controller of the microcontroller typically needs specific clock settings. Consult the user's guide of the microcontroller to understand the requirements. Alternatively, you may copy the setup of an <a class="el" href="nw_examples.html">example project</a> that is provided for various evaluation boards.</li>
</ul>
<h1><a class="anchor" id="nw_PHY_Configuration"></a>
Ethernet PHY Configuration</h1>
<p>For Ethernet network communication, usually an external Ethernet PHY is required to interface the physical line to the digital MAC of the microcontroller device. The MAC usually contains two buses:</p>
<ol type="1">
<li>Data bus: <a href="https://en.wikipedia.org/wiki/Media-independent_interface" target="_blank">MII, RMII,</a> or Serial Network Interface (SNI)</li>
<li>Management bus: Serial Management Interface (<b>SMI</b>) (using MDC and MDIO)</li>
</ol>
<p>SMI is used to access the PHY’s internal registers to read the state of the link (up/down), duplex mode, speed, and to restart auto-negotiation etc. SMI is a serial bus, which allows to connect up to 32 devices. Devices on the bus are accessed using a 5-bit device address. A default device address is hardware configurable by pin-strapping on the device (some pins are sampled when a reset is asserted or at power-up).</p>
<p>The device’s internal weak pull-up or pull-down resistors define a default device address. This address can be changed by connecting strong pull-up or pull-down resistors externally. In this case, the <code>ETH_PHY_ADDR</code> in the PHY driver needs to be changed accordingly to be able to control the PHY and to communicate with it. Use the <b>Options for Component</b> dialog to override the default setting for <code>ETH_PHY_ADDR:</code> </p>
<div class="image">
<img src="eth_phy_config.png" alt="eth_phy_config.png"/>
</div>
<h1><a class="anchor" id="nw_Device_Configuration"></a>
Network Configuration</h1>
<p>All configuration files for the Network Component are listed in the Project window below the Component Class <b>Network</b>.</p>
<h2>Network Core </h2>
<div class="image">
<img src="net_config_c.png" alt="net_config_c.png"/>
<div class="caption">
Net_Config.c Configuration File</div></div>
<p> The Network Core configuration file <b>Net_Config.c</b> contains the setting for the <b>Local Host Name</b>. This is a name under which the network device can be accessed on a local area network (<b>LAN</b>). This requires a <a class="el" href="group__using__ethernet__interfaces__conf.html">NetBIOS Name Service</a> to be enabled in the configuration. This name is very useful if you don't know the IP address that has been assigned to your device by the DHCP server.</p>
<p>The <b>Memory Pool Size</b> specifies the amount of RAM in bytes allocated for the memory pool. The buffers for the network packets are allocated from this memory pool. Usually, the default value of 12000 bytes is sufficient.</p>
<p>Many <a class="el" href="group__net_services.html">Network Services</a> are started by the Network Core automatically. If you disable <b>Start System Service</b>, you need to enable/start them at runtime using the dedicated functions for that.</p>
<p>To change the default OS resource settings for the Network Core, use <b>Core Thread Stack Size</b>. The default value is 1024 bytes. The default Core Thread priority is <b>osPriorityNormal</b>. You can change this priority by changing the <b>NET_THREAD_PRIORITY</b> defined in this configuration file. This priority must be lower than the priorities of the network interface threads.</p>
<h2>Network Interface </h2>
<p>The Network Interface configuration files <b>Net_Config_<em>Interface</em>_<em>n</em>.h</b> contain general IP address and other settings. You also need to specify the hardware driver number that is to be used with the network interface. In case of Ethernet for example, this is usually 0. If you are using a SLIP or PPP over a serial connection, you need to specify the hardware driver number of the exact UART you wish to use. All settings for the different interfaces are described here:</p>
<ul>
<li><a class="el" href="group__using__ethernet__interfaces__conf.html">Net_Config_ETH_0.h</a></li>
<li><a class="el" href="group__using__wifi__interfaces__conf.html">Net_Config_WiFi_0.h</a></li>
<li><a class="el" href="group__using__ppp__interfaces__conf.html">Net_Config_PPP.h</a></li>
<li><a class="el" href="group__using__slip__interfaces__conf.html">Net_Config_SLIP.h</a></li>
</ul>
<h2>Network Socket </h2>
<p>Usually, the needs of most applications are served by using the default settings for the sockets. Of course, there are configuration files for all three socket types that are specified in</p>
<ul>
<li><a class="el" href="group__using__network__sockets__bsd__conf.html">Net_Config_BSD.h</a></li>
<li><a class="el" href="group__using__network__sockets__tcp__conf.html">Net_Config_TCP.h</a></li>
<li><a class="el" href="group__using__network__sockets__udp__conf.html">Net_Config_UDP.h</a></li>
</ul>
<h2>Network Service </h2>
<p>The configuration files for all the Network Services are explained in the respective section:</p>
<ul>
<li><a class="el" href="group__ws__configuration.html">Net_Config_HTTP_Server.h</a></li>
<li><a class="el" href="group__using__ftp__server__conf.html">Net_Config_FTP_Server.h</a></li>
<li><a class="el" href="group__using__ftpc__conf.html">Net_Config_FTP_Client.h</a></li>
<li><a class="el" href="group__using__tftp__server__conf.html">Net_Config_TFTP_Server.h</a></li>
<li><a class="el" href="group__using__tftpc__conf.html">Net_Config_TFTP_Client.h</a></li>
<li><a class="el" href="group__telnet__server__conf.html">Net_Config_Telnet_Server.h</a></li>
<li><a class="el" href="group__using__snmp__agent__conf.html">Net_Config_SNMP_Agent.h</a></li>
<li><a class="el" href="group__using__dns__client__conf.html">Net_Config_DNS_Client.h</a></li>
<li><a class="el" href="group__using__sntp__client__conf.html">Net_Config_SNTP_Client.h</a></li>
<li><a class="el" href="group__using__smtpc__conf.html">Net_Config_SMTP_Client.h</a></li>
</ul>
<h1><a class="anchor" id="nw_security_config"></a>
Security Configuration</h1>
<p>The <b>mbed</b> <b>TLS</b> component provides an API for <a class="el" href="secure_communication.html">secure communication</a>. When selecting this software component, the <b>mbedTLS_config.h</b> configuration file is added to the project. The proper usage of this file is out of the scope of this document. For further information, check the online documentation of  <script>link_ext('mbedTLS');</script>.</p>
<h1><a class="anchor" id="nw_system_resources"></a>
System Resource Configuration</h1>
<p>For proper operation, the Network Component requires some system configuration settings. The requirements are:</p>
<ul>
<li>Additional <b>stack</b> size of <b>512 bytes</b>. This can be configured in the device's <script>link_ext('startup_device');</script> file (<code>Stack_Size</code>).</li>
<li>Additional two <b>threads</b> when Ethernet Interface is enabled (<code>netCore_Thread</code> and <code>netETH_Thread</code>).<ul>
<li>If you use <b>RTX v5</b>, you do not need to change the <b>RTX settings</b>, because all resources are statically allocated.</li>
<li>If you use <b>RTX v4</b>, you must change the following settings in the <script>link_ext('RTX-Conf-CM4');</script> file:<ul>
<li>Increase the <b>Number of concurrent running user threads</b> by <b>2</b> </li>
<li>Increase the <b>Number of threads with user-provided stack size</b> by <b>2</b> </li>
<li>Increase <b>Total stack size [bytes] for threads with user-provided stack size</b> by <b>1536 bytes</b></li>
<li>Enable <b>User Timers</b></li>
</ul>
</li>
</ul>
</li>
</ul>
<p>For more information, check the Network Component's <a class="el" href="nw_resource_requirements.html">Resource Requirements</a> section.</p>
<h1><a class="anchor" id="nw_User_Code_Implementation"></a>
User Code Implementation</h1>
<p>Before using the networking communications, the Network Core must be initialized with the function <a class="el" href="group__net_sys___func.html#ga0c68e74df79a37750413f72518f63f73">netInitialize</a>. The function initializes the Network system resources and creates threads and other RTOS objects. The initialization is usually executed from the <b>app_main</b> thread.</p>
<p>The initialization process is different depending on which network interface is used:</p>
<ul>
<li><b>Ethernet</b> <b>interface</b> <div class="fragment"><div class="line">__NO_RETURN <span class="keyword">static</span> <span class="keywordtype">void</span> app_main (<span class="keywordtype">void</span> *arg) {</div>
<div class="line">  (void)arg;</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="group__net_sys___func.html#ga0c68e74df79a37750413f72518f63f73">netInitialize</a> ();</div>
<div class="line"> </div>
<div class="line">  osThreadTerminate(osThreadGetId());</div>
<div class="line">  <span class="keywordflow">for</span>(;;);</div>
<div class="line">}</div>
</div><!-- fragment --></li>
<li><b>WiFi</b> <b>interface</b> <div class="fragment"><div class="line">__NO_RETURN <span class="keyword">static</span> <span class="keywordtype">void</span> app_main (<span class="keywordtype">void</span> *arg) {</div>
<div class="line">  <a class="code" href="group___wifi__structs.html#struct_n_e_t___w_i_f_i___c_o_n_f_i_g">NET_WIFI_CONFIG</a> wifi_config;</div>
<div class="line">  (void)arg;</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="group__net_sys___func.html#ga0c68e74df79a37750413f72518f63f73">netInitialize</a> ();</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Configure wireless parameters</span></div>
<div class="line">  wifi_config.<a class="code" href="group___wifi__structs.html#a587ba0cb07f02913598610049a3bbb79">ssid</a>       = <span class="stringliteral">&quot;GuestAccess&quot;</span>;</div>
<div class="line">  wifi_config.<a class="code" href="group___wifi__structs.html#aa4a2ebcb494493f648ae1e6975672575">password</a>   = <span class="stringliteral">&quot;guest&quot;</span>;</div>
<div class="line">  wifi_config.<a class="code" href="group___wifi__structs.html#aec30474f97bb7bcc198d8d36b646f4f0">security</a>   = <a class="code" href="rl__net__ds_8h.html#ga47b4f67d1bf39195b04faa194294b2dcaba44563e1f60cea0f2b6f23db50ee0db">netWiFi_SecurityWPA2</a>;</div>
<div class="line">  wifi_config.<a class="code" href="group___wifi__structs.html#a715f5cb061d11eb75981741eda4dafcd">channel</a>    = 0;</div>
<div class="line">  wifi_config.<a class="code" href="group___wifi__structs.html#afe897994ccb1383db83bc3355e69b5a7">wps_method</a> = <a class="code" href="rl__net__ds_8h.html#ga923615425840e0578bc76e8ba1b9147ea21b783b9fc36e1efdfbd6e429c083a99">netWiFi_WPS_None</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Connect to wireless network</span></div>
<div class="line">  <a class="code" href="group__wifi__user__api.html#gad5f9a8d136edec8f731af4c0f43e5b15">netWiFi_Activate</a> (0, &amp;wifi_config);</div>
<div class="line"> </div>
<div class="line">  osThreadTerminate(osThreadGetId());</div>
<div class="line">  <span class="keywordflow">for</span>(;;);</div>
<div class="line">}</div>
</div><!-- fragment --></li>
<li><b>PPP</b> <b>interface</b> <div class="fragment"><div class="line">__NO_RETURN <span class="keyword">static</span> <span class="keywordtype">void</span> app_main (<span class="keywordtype">void</span> *arg) {</div>
<div class="line">  (void)arg;</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="group__net_sys___func.html#ga0c68e74df79a37750413f72518f63f73">netInitialize</a> ();</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Connect to remote PPP server</span></div>
<div class="line">  <a class="code" href="group__ppp__user__api.html#gaff5343f51863e458736684f4d6bc5e91">netPPP_Connect</a> (<span class="stringliteral">&quot;04213372&quot;</span>, <span class="stringliteral">&quot;Guest&quot;</span>, <span class="stringliteral">&quot;test&quot;</span>)</div>
<div class="line"> </div>
<div class="line">  osThreadTerminate(osThreadGetId());</div>
<div class="line">  for(;;);</div>
<div class="line">}</div>
</div><!-- fragment --></li>
</ul>
<h2>User Code Templates </h2>
 <script>link_ext('uv4_user_code_template');</script> files provide access to all functions that are required to communicate over the Network. The available functions are explained in the <a href="./modules.html" class="el">Reference</a> section of the Network Component. These routines can be adapted to the needs of the microcontroller application, in case more functionality is needed.</p>
<p>The following templates are available for the Network component: </p>
<table class="doxtable">
<tr>
<th>Template Name</th><th>User Functions  </th></tr>
<tr>
<td>DNS_Client.c </td><td><code>dns_cbfunc</code> (Callback function for notification about DNS client events), <code>resolve_host</code> (DNS resolving process) </td></tr>
<tr>
<td>FTP_Client_UIF.c </td><td><a class="el" href="group__ftpc__operation.html#ga2d45d1e964d8960971fb852b45f4cdf8">netFTPc_Process</a> (Request parameters for FTP client session), <a class="el" href="group__ftpc__operation.html#ga6c61683ecd364f193ceebd3aa6974288">netFTPc_Notify</a> (Notify the user application when FTP client operation ends) </td></tr>
<tr>
<td>FTP_Server_Access.c </td><td><a class="el" href="group__ftp__access__filter__mui.html#ga38c2ff05058bdb0ca8b3c122bffc4bb9">netFTPs_AcceptClient</a> (Accept or deny connection from remote FTP client) </td></tr>
<tr>
<td>FTP_Server_Event.c </td><td><a class="el" href="group__ftp__user__notification.html#ga32dd710872b1d0a7d244af76f942d807">netFTPs_Notify</a> (Notify the user application about events in FTP server service) </td></tr>
<tr>
<td>FTP_Server_Multiuser.c </td><td><a class="el" href="group__ftp__access__filter__mui.html#gab204f191fe2ed707562ca0246dab0617">netFTPs_CheckUsername</a> (Check if an user account exists), <a class="el" href="group__ftp__access__filter__mui.html#ga100ca730f5e9e891ede74caf51d0ce3a">netFTPs_CheckPassword</a> (Check user account password), <a class="el" href="group__ftp__access__filter__mui.html#ga946cfca1047c9d91737ba310ba4f2238">netFTPs_FileAccess</a> (Check if remote user is allowed to access a file) </td></tr>
<tr>
<td>HTTP_Server_Access.c </td><td><a class="el" href="group__ws__access__filtering__mui.html#gaf36a37f99a76e8ca958fbde377cee73d">netHTTPs_AcceptClient</a> (Accept or deny connection from remote HTTP client) </td></tr>
<tr>
<td>HTTP_Server_CGI.c </td><td><a class="el" href="group__ws__cgi__script.html#ga7d01432d1adc6a5a0e21eacd82d55910">netCGI_ProcessQuery</a> (Process query string received by GET request), <a class="el" href="group__ws__cgi__script.html#gafa3ddab948908d6fd4926fe3a3da06e9">netCGI_ProcessData</a> (Process data received by POST request), <a class="el" href="group__ws__cgi__script.html#ga5203e3a1a0f95a8b76fb83bec73e4be8">netCGI_Script</a> (Generate dynamic web data from a script line) </td></tr>
<tr>
<td>HTTP_Server_Error.c </td><td><code>net_http_error</code> (Define user-friendly HTTP error messages) </td></tr>
<tr>
<td>HTTP_Server_Multiuser.c </td><td><a class="el" href="group__ws__access__filtering__mui.html#gaee074414cedf60bc3d259f6647d67e0d">netHTTPs_CheckAccount</a> (Check if an user account exists), <a class="el" href="group__ws__access__filtering__mui.html#ga5844644be087d719f4d4f7e7e92993e4">netHTTPs_FileAccess</a> (Check if remote user is allowed to access a file) </td></tr>
<tr>
<td>SMTP_Client_UIF.c </td><td><a class="el" href="group__smtpc__operation.html#ga9f299f586e428d9a005c1ca9668fd7b3">netSMTPc_Process</a> (Request parameters for SMTP client session), <a class="el" href="group__smtpc__operation.html#ga5240c89a181c1ddb07bbe888a6a8657f">netSMTPc_Notify</a> (Notify the user application when SMTP client operation ends), <a class="el" href="group__smtpc__operation.html#ga58a7a56c6bda480e21591ee33c028aa5">netSMTPc_AcceptAuthentication</a> (Accept or deny authentication requested by SMTP server) </td></tr>
<tr>
<td>SNMP_Agent_MIB.c </td><td><code>mib_table</code> (Defines MIB information data table), <code>register_mib_table</code> (Registers a MIB table in SNMP agent) </td></tr>
<tr>
<td>TCP_Socket_Client.c </td><td><code>tcp_cb_client</code> (Notify the user application about TCP socket events), <code>send_data</code> (Connect to TCP server and send data) </td></tr>
<tr>
<td>TCP_Socket_Server.c </td><td><code>tcp_cb_server</code> (Notify the user application about TCP socket events) </td></tr>
<tr>
<td>Telnet_Server_Access.c </td><td><a class="el" href="group__telnet__access__filter__mui.html#ga3ec99f8332f7734909fb66808daca8f4">netTELNETs_AcceptClient</a> (Accept or deny connection from remote Telnet client) </td></tr>
<tr>
<td>Telnet_Server_Multiuser.c </td><td><a class="el" href="group__telnet__access__filter__mui.html#ga73d0d9e1ca34deaef1a4d0ae60e4f899">netTELNETs_CheckUsername</a> (Check if an user account exists), <a class="el" href="group__telnet__access__filter__mui.html#ga2ce267a4349c5723e02eee6e22149bb8">netTELNETs_CheckPassword</a> (Check user account password) </td></tr>
<tr>
<td>Telnet_Server_UIF.c </td><td><a class="el" href="group__telnet__user__notification.html#ga66dbef28a03b6885922151c38bf3b0e2">netTELNETs_ProcessMessage</a> (Request message for Telnet server session), <a class="el" href="group__telnet__user__notification.html#gae28cb4a796ee5e59ad5e32dccc969c76">netTELNETs_ProcessCommand</a> (Process a command and generate response) </td></tr>
<tr>
<td>TFTP_Client_UIF.c </td><td><code>tftp_client_notify</code> (Notify the user application when TFTP client operation ends) </td></tr>
<tr>
<td>TFTP_Server_Access.c </td><td><a class="el" href="group__tftp__server__access.html#gab05c8ba4e93e67235ca3ac5e955288f4">netTFTPs_AcceptClient</a> (Accept or deny connection from remote TFTP client) </td></tr>
<tr>
<td>UDP_Socket.c </td><td><code>udp_cb_func</code> (Notify the user application about UDP socket events), <code>send_udp_data</code> (Send UDP data to destination client) </td></tr>
</table>
<h1><a class="anchor" id="nw_debugging"></a>
Debugging</h1>
<p>The Network Component is distributed in library form and doesn't allow direct code debug. However, it can be configured to generate debug events and provide dynamic visibility to the component operation.</p>
<p>The following variants can be selected for the <b>Network:Core</b> component in the <b>Manage Run-Time Environment</b> window:</p>
<ul>
<li><a class="el" href="network_create_app.html#netEvrSupport">Debug</a>: this variant supports event annotations for the <script>link_ext('Event-Recorder-About');</script> and makes it very easy to analyze the internal operation of the Network Component during application debug.</li>
<li><a class="el" href="network_diffs.html#netDebugStdio">Debug STDIO</a>: this is a legacy debug variant that prints event information as ASCII messages.</li>
<li><b>Release</b>: this variant does not include additional debugging code. Use this variant when deploying the application.</li>
</ul>
<p>The figure below shows selection of <b>IPv4/IPv6 Debug</b> variant as an example. </p>
<div class="image">
<img src="nw_debug_variant.png" alt="nw_debug_variant.png"/>
</div>
<p>The <a class="el" href="group__net__evr.html">Debug Events</a> describes the events implemented in Network Services.</p>
<dl class="section note"><dt>Note</dt><dd>Users of MDK-Plus edition can only access <b> IPv4 Debug/Debug STDIO/Release</b> variants.</dd></dl>
<h2><a class="anchor" id="netEvrSupport"></a>
Event Recorder Support</h2>
 <script>link_ext('Event-Recorder-About');</script> is a powerful tool that provides visibility to the dynamic execution of the program. The Network Component generates <a class="el" href="group__net__evr.html">a broad set of Debug Events</a> for the Event Recorder and implements required infrastructure to interface with it.</p>
<p>To use the Event Recorder together with Network Component, it is required to create an image with event generation support. The necessary steps are:</p>
<ol type="1">
<li> <script>link_ext('Debug-Variant-Select');</script>: in the RTE management dialog select the <b>Debug</b> variant for the target <b>Network:Core</b> software component.</li>
<li> <script>link_ext('Event-Recorder-Enable');</script>: in the RTE management dialog enable the software component <b>Compiler:Event Recorder</b>.</li>
<li> <script>link_ext('Event-Recorder-Initialize');</script>: in the application code, call the function <b>EventRecorderInitialize</b>.</li>
<li> <script>link_ext('Event-Recorder-Configure');</script>: if necessary, adjust default Event Recorder configuration.</li>
<li>Build the application code, download it to the target hardware and start debug session.</li>
</ol>
<p>Now, when the network services generate event information, it can be viewed in the <script>link_ext('uv4-Event-Recorder');</script>.</p>
<h2>Event filtering: </h2>
<p>The Network debug variant generates lots of debug events. This might have an impact on the operation of the Network library. It is a good idea to disable debug for modules, which are not used, or at least to reduce the number of messages, that are generated. Therefore, enable <b>Error</b> events for such modules and enable <b>Debug</b> events only for the modules you are focused on.</p>
<h2>Event IDs </h2>
<p>The network component uses the following event IDs:</p>
<table class="doxtable">
<tr>
<th>Component </th><th>Event ID  </th></tr>
<tr>
<td>Net_SYS </td><td>0xC0 </td></tr>
<tr>
<td>Net_MEM </td><td>0xC1 </td></tr>
<tr>
<td>Net_ETH </td><td>0xC2 </td></tr>
<tr>
<td>Net_WiFi </td><td>0xDD </td></tr>
<tr>
<td>Net_PPP </td><td>0xC3 </td></tr>
<tr>
<td>Net_SLIP </td><td>0xC4 </td></tr>
<tr>
<td>Net_LOOP </td><td>0xC5 </td></tr>
<tr>
<td>Net_IP4 </td><td>0xC6 </td></tr>
<tr>
<td>Net_ICMP </td><td>0xC7 </td></tr>
<tr>
<td>Net_IGMP </td><td>0xC8 </td></tr>
<tr>
<td>Net_NBNS </td><td>0xC9 </td></tr>
<tr>
<td>Net_DHCP </td><td>0xCA </td></tr>
<tr>
<td>Net_ARP </td><td>0xCB </td></tr>
<tr>
<td>Net_IP6 </td><td>0xCC </td></tr>
<tr>
<td>Net_ICMP6 </td><td>0xCD </td></tr>
<tr>
<td>Net_DHCP6 </td><td>0xCE </td></tr>
<tr>
<td>Net_NDP </td><td>0xCF </td></tr>
<tr>
<td>Net_UDP </td><td>0xD0 </td></tr>
<tr>
<td>Net_TCP </td><td>0xD1 </td></tr>
<tr>
<td>Net_BSD </td><td>0xD2 </td></tr>
<tr>
<td>Net_HTTPs </td><td>0xD3 </td></tr>
<tr>
<td>Net_FTPs </td><td>0xD4 </td></tr>
<tr>
<td>Net_FTPc </td><td>0xD5 </td></tr>
<tr>
<td>Net_Teln </td><td>0xD6 </td></tr>
<tr>
<td>Net_TFTPs </td><td>0xD7 </td></tr>
<tr>
<td>Net_TFTPc </td><td>0xD8 </td></tr>
<tr>
<td>Net_SMTP </td><td>0xD9 </td></tr>
<tr>
<td>Net_DNS </td><td>0xDA </td></tr>
<tr>
<td>Net_SNMP </td><td>0xDB </td></tr>
<tr>
<td>Net_SNTP </td><td>0xDC </td></tr>
</table>
<h1><a class="anchor" id="nw_runtime_config"></a>
Runtime Configuration</h1>
<p>It is often necessary to change the parameters and mode of operation of the network interface at startup or runtime. System control functions allow reading and changing the settings of the network interface and the system (for example the <a href="https://en.wikipedia.org/wiki/Hostname" target="_blank">hostname</a>).</p>
<p>This is required for using the same application code for serial production of embedded devices. The <b>runtime</b> <b>configuration</b> feature enables reading of configuration parameters from an EEPROM or SD Card and configuring the network interface for each embedded device differently.</p>
<p>To control the network interface options, you can use:</p>
<ul>
<li><a class="el" href="group__common__user__api.html#gadbf28bb56266770f9b1d276c48c13d36">netIF_GetOption</a> function to retrieve the options</li>
<li><a class="el" href="group__common__user__api.html#ga919bfb395143e0bc1775106080c61eb6">netIF_SetOption</a> function to set the options</li>
<li><a class="el" href="group__common__user__api.html#ga7e16ce8f65945bfc49bee15172d6ad41">netIF_SetDefault</a> function to set default interface for internet access</li>
</ul>
<p>The options which can be changed are defined in the <a class="el" href="group__net_interfaces___enums.html#ga2e0460c920b348a8633c2e54ceecbed5">netIF_Option</a> enumerator. However, some interfaces do not support the complete set of available options. For example, the PPP interface does not have a MAC address. If you try to modify an unsupported option, an error is returned.</p>
<p>The <a href="https://en.wikipedia.org/wiki/Localhost" target="_blank">localhost</a> name is used to access the embedded system without knowledge of its IP address. <a class="el" href="group__net_sys___func.html#ga6eda1bb2895a98252a851160c15111a5">netSYS_GetHostName</a> is used to retrieve the localhost name, whereas <a class="el" href="group__net_sys___func.html#ga141ae4581698cb95e5fc5c8458fa9710">netSYS_SetHostName</a> changes the localhost name.</p>
<p>The <a href="https://en.wikipedia.org/wiki/Dynamic_Host_Configuration_Protocol" target="_blank">DHCP</a> client can be disabled or enabled at runtime. When disabled, the user provided network parameters defined in the <b>Net_Config_ETH_0.h</b> or <b>Net_Config_WiFi_0.h</b> configuration files are used. Switch the state of the DHCP client using <a class="el" href="group__common__user__api.html#gad8ddb783cbb076297f64c3aa13a7d930">netDHCP_Disable</a> and <a class="el" href="group__common__user__api.html#gace7634f951ec523cccc505b5d2ffd5a7">netDHCP_Enable</a>.</p>
<dl class="section note"><dt>Note</dt><dd>Each embedded Ethernet device must have a unique <b>MAC</b> <b>address</b>, <b>IP</b> <b>address</b>, and <b>hostname</b>. This is very important when multiple devices are connected to the same LAN. Otherwise, the system might not work (due to collisions or disturbed network communications).</dd></dl>
<p><b>Code</b> <b>Example</b> </p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="rl__net_8h.html">rl_net.h</a>&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">/* The following values are read from EEPROM */</span></div>
<div class="line"><span class="keyword">const</span> <span class="keywordtype">char</span> mac_addr[]  = { <span class="stringliteral">&quot;00-01-02-32-3c-46&quot;</span> };</div>
<div class="line"><span class="keyword">const</span> <span class="keywordtype">char</span> ip_addr[]   = { <span class="stringliteral">&quot;192.168.0.150&quot;</span>     };</div>
<div class="line"><span class="keyword">const</span> <span class="keywordtype">char</span> def_gw[]    = { <span class="stringliteral">&quot;192.168.0.1&quot;</span>       };</div>
<div class="line"><span class="keyword">const</span> <span class="keywordtype">char</span> net_mask[]  = { <span class="stringliteral">&quot;255.255.255.0&quot;</span>     };</div>
<div class="line"><span class="keyword">const</span> <span class="keywordtype">char</span> pri_dns[]   = { <span class="stringliteral">&quot;194.25.2.129&quot;</span>      };</div>
<div class="line"><span class="keyword">const</span> <span class="keywordtype">char</span> sec_dns[]   = { <span class="stringliteral">&quot;194.25.2.130&quot;</span>      };</div>
<div class="line"><span class="keyword">const</span> <span class="keywordtype">char</span> host_name[] = { <span class="stringliteral">&quot;Keil_MCB&quot;</span>          };</div>
<div class="line"><span class="keywordtype">bool</span> DHCP_enabled      = <span class="keyword">false</span>;</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> main (<span class="keywordtype">void</span>) {</div>
<div class="line">  uint8_t buf[8];</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="group__net_sys___func.html#ga0c68e74df79a37750413f72518f63f73">netInitialize</a> ();</div>
<div class="line"> </div>
<div class="line">  <span class="comment">/* Change host name */</span></div>
<div class="line">  <a class="code" href="group__net_sys___func.html#ga141ae4581698cb95e5fc5c8458fa9710">netSYS_SetHostName</a> (host_name);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">/* Change MAC address */</span></div>
<div class="line">  <a class="code" href="group__net_gen___addr_conv_func.html#ga8f9dc823db5abb2bc6ccd8e1788c92da">netMAC_aton</a> (mac_addr, buf);</div>
<div class="line">  <a class="code" href="group__common__user__api.html#ga919bfb395143e0bc1775106080c61eb6">netIF_SetOption</a> (<a class="code" href="rl__net__ds_8h.html#a005856112372179cbbdb9f815a563a6c">NET_IF_CLASS_ETH</a> | 0, <a class="code" href="rl__net__ds_8h.html#ga2e0460c920b348a8633c2e54ceecbed5a3433c9bf63b20186d9c9dc7359dc3d7e">netIF_OptionMAC_Address</a>, buf, <a class="code" href="rl__net__ds_8h.html#abc6c76b89cc97f1dd7ffb8f1a82e0754">NET_ADDR_ETH_LEN</a>);</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> (DHCP_enabled == <span class="keyword">false</span>) {</div>
<div class="line">    <span class="comment">/* Static configuration mode */</span> </div>
<div class="line">    <a class="code" href="group__common__user__api.html#gad8ddb783cbb076297f64c3aa13a7d930">netDHCP_Disable</a> (0);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Change IP address */</span></div>
<div class="line">    <a class="code" href="group__net_gen___addr_conv_func.html#ga39518491393bd2b4c6f32df03768b6b8">netIP_aton</a> (ip_addr, <a class="code" href="rl__net__ds_8h.html#ab5ae61a54f36e338a8dc06cee088d89f">NET_ADDR_IP4</a>, buf);</div>
<div class="line">    <a class="code" href="group__common__user__api.html#ga919bfb395143e0bc1775106080c61eb6">netIF_SetOption</a> (<a class="code" href="rl__net__ds_8h.html#a005856112372179cbbdb9f815a563a6c">NET_IF_CLASS_ETH</a> | 0, <a class="code" href="rl__net__ds_8h.html#ga2e0460c920b348a8633c2e54ceecbed5a3746e578ee900eb8d9619d36585a5e21">netIF_OptionIP4_Address</a>, buf, <a class="code" href="rl__net__ds_8h.html#a592ab2bc0921be0762e26d38621f62cd">NET_ADDR_IP4_LEN</a>);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Change Network mask */</span></div>
<div class="line">    <a class="code" href="group__net_gen___addr_conv_func.html#ga39518491393bd2b4c6f32df03768b6b8">netIP_aton</a> (net_mask, <a class="code" href="rl__net__ds_8h.html#ab5ae61a54f36e338a8dc06cee088d89f">NET_ADDR_IP4</a>, buf);</div>
<div class="line">    <a class="code" href="group__common__user__api.html#ga919bfb395143e0bc1775106080c61eb6">netIF_SetOption</a> (<a class="code" href="rl__net__ds_8h.html#a005856112372179cbbdb9f815a563a6c">NET_IF_CLASS_ETH</a> | 0, <a class="code" href="rl__net__ds_8h.html#ga2e0460c920b348a8633c2e54ceecbed5aae9f616813558d8a345bda00ca47004c">netIF_OptionIP4_SubnetMask</a>, buf, <a class="code" href="rl__net__ds_8h.html#a592ab2bc0921be0762e26d38621f62cd">NET_ADDR_IP4_LEN</a>);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Change Default Gateway address */</span></div>
<div class="line">    <a class="code" href="group__net_gen___addr_conv_func.html#ga39518491393bd2b4c6f32df03768b6b8">netIP_aton</a> (def_gw, <a class="code" href="rl__net__ds_8h.html#ab5ae61a54f36e338a8dc06cee088d89f">NET_ADDR_IP4</a>, buf);</div>
<div class="line">    <a class="code" href="group__common__user__api.html#ga919bfb395143e0bc1775106080c61eb6">netIF_SetOption</a> (<a class="code" href="rl__net__ds_8h.html#a005856112372179cbbdb9f815a563a6c">NET_IF_CLASS_ETH</a> | 0, <a class="code" href="rl__net__ds_8h.html#ga2e0460c920b348a8633c2e54ceecbed5abc895891ba1aea3b621808e613361208">netIF_OptionIP4_DefaultGateway</a>, buf, <a class="code" href="rl__net__ds_8h.html#a592ab2bc0921be0762e26d38621f62cd">NET_ADDR_IP4_LEN</a>);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Change Primary DNS Server address */</span></div>
<div class="line">    <a class="code" href="group__net_gen___addr_conv_func.html#ga39518491393bd2b4c6f32df03768b6b8">netIP_aton</a> (pri_dns, <a class="code" href="rl__net__ds_8h.html#ab5ae61a54f36e338a8dc06cee088d89f">NET_ADDR_IP4</a>, buf);</div>
<div class="line">    <a class="code" href="group__common__user__api.html#ga919bfb395143e0bc1775106080c61eb6">netIF_SetOption</a> (<a class="code" href="rl__net__ds_8h.html#a005856112372179cbbdb9f815a563a6c">NET_IF_CLASS_ETH</a> | 0, <a class="code" href="rl__net__ds_8h.html#ga2e0460c920b348a8633c2e54ceecbed5ad1dc6f54d4e047357eb0c5dacc75f3c2">netIF_OptionIP4_PrimaryDNS</a>, buf, <a class="code" href="rl__net__ds_8h.html#a592ab2bc0921be0762e26d38621f62cd">NET_ADDR_IP4_LEN</a>);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Change Secondary DNS Server address */</span></div>
<div class="line">    <a class="code" href="group__net_gen___addr_conv_func.html#ga39518491393bd2b4c6f32df03768b6b8">netIP_aton</a> (sec_dns, <a class="code" href="rl__net__ds_8h.html#ab5ae61a54f36e338a8dc06cee088d89f">NET_ADDR_IP4</a>, buf);</div>
<div class="line">    <a class="code" href="group__common__user__api.html#ga919bfb395143e0bc1775106080c61eb6">netIF_SetOption</a> (<a class="code" href="rl__net__ds_8h.html#a005856112372179cbbdb9f815a563a6c">NET_IF_CLASS_ETH</a> | 0, <a class="code" href="rl__net__ds_8h.html#ga2e0460c920b348a8633c2e54ceecbed5ad735ade79f2df5d930673a6be414dfc2">netIF_OptionIP4_SecondaryDNS</a>, buf, <a class="code" href="rl__net__ds_8h.html#a592ab2bc0921be0762e26d38621f62cd">NET_ADDR_IP4_LEN</a>);</div>
<div class="line">  }</div>
<div class="line">}</div>
</div><!-- fragment --> </div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Tue May 25 2021 13:57:37 for Network Component by ARM Ltd. All rights reserved.
	<!--
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.6 
	-->
	</li>
  </ul>
</div>
</body>
</html>
