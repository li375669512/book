<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>Management Information Base (MIB) Interface</title>
<title>Network Component: Management Information Base (MIB) Interface</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="drv.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="printComponentTabs.js"></script>
<script type="text/javascript" src="URL_keys.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="stylsheetf" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 46px;">
  <td id="projectlogo"><img alt="Logo" src="keilarm.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">Network Component
   &#160;<span id="projectnumber">Version 7.15.0</span>
   </div>
   <div id="projectbrief">MDK Middleware for IPv4 and IPv6 Networking</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<div id="DRVnav" class="tabs1">
    <ul class="tablist">
      <script type="text/javascript">
		<!--
		writeComponentTabs.call(this);
		//-->
      </script>
	  </ul>
</div>
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Usage&#160;and&#160;Description</span></a></li>
      <li><a href="modules.html"><span>Reference</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('group__mib__interface.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Management Information Base (MIB) Interface<div class="ingroups"><a class="el" href="group__net_s_n_m_p___func.html">SNMP Agent</a></div></div>  </div>
</div><!--header-->
<div class="contents">

<p>Management Information Base (MIB) Interface.  
<a href="#details">More...</a></p>
<p>Management Information Base (MIB) Interface. </p>
<p>The database controlled by the SNMP Agent is referred to as the <a href="http://en.wikipedia.org/wiki/Management_information_base" target="_blank">Management Information Base (MIB)</a>. It is a standard set of statistical and control values. SNMP allows the extension of these standard values with values specific to a particular agent through the use of private MIBs.</p>
<p>The definitions of MIB variables supported by a particular agent are incorporated in descriptor files, written in <a href="http://en.wikipedia.org/wiki/Abstract_Syntax_Notation_One" target="_blank">Abstract Syntax Notation (ASN.1)</a> format, made available to network management client programs so that they can become aware of these MIB variables and their usage.</p>
<p>The MIB variables are referred to as MIB <a href="http://en.wikipedia.org/wiki/Object_identifier" target="_blank">Object Identifiers (OIDs)</a>. OID names are hierarchy structured and unique. SNMP uses the OID to identify objects on each network element (device running SNMP agent) that can be managed using SNMP.</p>
<p>The SNMP Agent manages MIB variables that are located in the <b>SNMP_Agent_MIB.c</b> template file. To add the file to your project, simply right-click on the Source group, select <b>Add New Item to Group</b>, then click on <b>User Code Template</b> and scroll in the template files list until you find the <b>SNMP Agent</b> template. The <b>SNMP_Agent_MIB.c</b> file has implemented a scaled-down <b>MIB-II</b> Management Information Base. Only the System <b>MIB</b> is defined by default. The user might expand this table by adding his own MIB variables.</p>
<p>The user can register a callback function with a MIB variable. This function gets called, when the SNMP Manager accesses the MIB variable. This concept allows the SNMP Manager to control the SNMP Agent system. For example to change LED outputs, to write text on embedded LCD module, to read push buttons or analog inputs, etc.</p>
<p><a class="anchor" id="mib_entry"></a></p>
<h2>MIB Entry </h2>
<p>The SNMP MIB entry information structure <a class="el" href="group__snmp__structs.html#struct_n_e_t___s_n_m_p___m_i_b___i_n_f_o">NET_SNMP_MIB_INFO</a> describes the MIB variable. The SNMP Agent uses this description to process local MIB variables. This structure is defined as follows: </p>
<div class="fragment"><div class="line"><span class="keyword">typedef</span> <span class="keyword">struct </span>net_snmp_mib_info {</div>
<div class="line">  uint8_t  type;                        <span class="comment">// Object Type</span></div>
<div class="line">  uint8_t  oid_len;                     <span class="comment">// Object ID length</span></div>
<div class="line">  uint8_t  oid[<a class="code" href="rl__net__ds_8h.html#aa68240bfc4b59f400d36cf6a9f3527d4">NET_SNMP_MIB_OID_SIZE</a>];  <span class="comment">// Object ID value</span></div>
<div class="line">  uint8_t  var_size;                    <span class="comment">// Size of a variable</span></div>
<div class="line">  <span class="keywordtype">void</span>     *var;                        <span class="comment">// Pointer to a variable</span></div>
<div class="line">  void     (*cb_func)(int32_t mode);    <span class="comment">// Write/Read event callback function</span></div>
<div class="line">} <span class="keyword">const</span> <a class="code" href="group__snmp__structs.html#struct_n_e_t___s_n_m_p___m_i_b___i_n_f_o">NET_SNMP_MIB_INFO</a>;</div>
</div><!-- fragment --><p> The components of <a class="el" href="group__snmp__structs.html#struct_n_e_t___s_n_m_p___m_i_b___i_n_f_o" title="SNMP-MIB Entry information. ">NET_SNMP_MIB_INFO</a> structure are:</p>
<ul>
<li>the <em>type</em> defines the MIB variable type: <table class="doxtable">
<tr>
<th>MIB Type </th><th>Description </th><th>Size  </th></tr>
<tr>
<td>NET_SNMP_MIB_INTEGER </td><td>Signed Integer </td><td>1, 2 or 4 bytes </td></tr>
<tr>
<td>NET_SNMP_MIB_OCTET_STR </td><td>Octet String entry </td><td>max. 110 characters </td></tr>
<tr>
<td>NET_SNMP_MIB_OBJECT_ID </td><td>Object Identifier entry </td><td>max. 17 bytes </td></tr>
<tr>
<td>NET_SNMP_MIB_IP_ADDR </td><td>IP Address entry </td><td>4 bytes </td></tr>
<tr>
<td>NET_SNMP_MIB_COUNTER </td><td>Counter entry </td><td>1, 2 or 4 bytes </td></tr>
<tr>
<td>NET_SNMP_MIB_GAUGE </td><td>Gauge entry </td><td>1, 2 or 4 bytes </td></tr>
<tr>
<td>NET_SNMP_MIB_TIME_TICKS </td><td>Time Ticks entry </td><td>4 bytes </td></tr>
</table>
The <em>type</em> component may be OR-ed with the <b>NET_SNMP_MIB_ATR_RO</b> read-only attribute. A read-only variable can not be changed by the SNMP Manager.</li>
<li>the OID specifies the Object Identification Name of the variable. It is length encoded:<ul>
<li><em>oid_len</em> specifies the length of the <em>oid</em>[] array.</li>
<li><em>oid</em>[NET_SNMP_MIB_OID_SIZE] array specifies the OID name - a length encoded binary array.</li>
</ul>
</li>
<li><em>var</em> specifies the Pointer to the variable and its Size:<ul>
<li><em>var_size</em> specifies the size of var variable.</li>
<li><em>var</em> is a pointer to the actual variable.</li>
</ul>
</li>
<li>the <em>cb_func</em> specifies a callback function which is called, when the variable is accessed by SNMP Manager. The callback function is not registered, when the value of <em>cb_func</em> is <span class="XML-Token">NULL</span>. The argument <em>mode</em> of the callback function specifies the access mode of SNMP Manager: <table class="doxtable">
<tr>
<th>Mode </th><th>Type of Access  </th></tr>
<tr>
<td>NET_SNMP_MIB_READ </td><td>Reads a MIB variable. </td></tr>
<tr>
<td>NET_SNMP_MIB_WRITE</td><td>Writes to a MIB variable. </td></tr>
</table>
<a class="anchor" id="mib_data_table"></a><h2>MIB Table </h2>
</li>
</ul>
<p>The <b>MIB</b> Table table is defined as an array. The components of this array are of type <a class="el" href="group__snmp__structs.html#struct_n_e_t___s_n_m_p___m_i_b___i_n_f_o">NET_SNMP_MIB_INFO</a>. </p>
<div class="fragment"><div class="line"><span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="group__snmp__structs.html#struct_n_e_t___s_n_m_p___m_i_b___i_n_f_o">NET_SNMP_MIB_INFO</a> mib_table[] = {</div>
<div class="line"><span class="comment">// ---------- System MIB ----------- </span></div>
<div class="line">  <span class="comment">// SysDescr Entry</span></div>
<div class="line">  { <a class="code" href="rl__net__ds_8h.html#a6e25c850163c27f9d1151943c1a52a72">NET_SNMP_MIB_OCTET_STR</a> | <a class="code" href="rl__net__ds_8h.html#a1caf9c451b6068cfc6c72abff08a756e">NET_SNMP_MIB_ATR_RO</a>,</div>
<div class="line">    8, {<a class="code" href="rl__net__ds_8h.html#aa4f513d3fe2e5edf191f3bdb498fa7d0">NET_SNMP_MIB_OID0</a>(1,3), 6, 1, 2, 1, 1, 1, 0},</div>
<div class="line">    <a class="code" href="rl__net__ds_8h.html#ab47bb233395f6f92e24dc4045c1b22af">NET_SNMP_MIB_STR</a>(<span class="stringliteral">&quot;Embedded System SNMP V1.0&quot;</span>),</div>
<div class="line">    NULL },</div>
<div class="line">  <span class="comment">// SysObjectID Entry</span></div>
<div class="line">  { <a class="code" href="rl__net__ds_8h.html#ae65e03dc842d28867c7b55a7e5d0ef14">NET_SNMP_MIB_OBJECT_ID</a> | <a class="code" href="rl__net__ds_8h.html#a1caf9c451b6068cfc6c72abff08a756e">NET_SNMP_MIB_ATR_RO</a>,</div>
<div class="line">    8, {<a class="code" href="rl__net__ds_8h.html#aa4f513d3fe2e5edf191f3bdb498fa7d0">NET_SNMP_MIB_OID0</a>(1,3), 6, 1, 2, 1, 1, 2, 0},</div>
<div class="line">    <a class="code" href="rl__net__ds_8h.html#ab47bb233395f6f92e24dc4045c1b22af">NET_SNMP_MIB_STR</a>(<span class="stringliteral">&quot;\x2b\x06\x01\x02\x01\x01\x02\x00&quot;</span>),</div>
<div class="line">    NULL },</div>
<div class="line">  <span class="comment">// SysUpTime Entry</span></div>
<div class="line">  { <a class="code" href="rl__net__ds_8h.html#a34ec36a2f3aa31cf7af547c1109aeb68">NET_SNMP_MIB_TIME_TICKS</a> | <a class="code" href="rl__net__ds_8h.html#a1caf9c451b6068cfc6c72abff08a756e">NET_SNMP_MIB_ATR_RO</a>,</div>
<div class="line">    8, {<a class="code" href="rl__net__ds_8h.html#aa4f513d3fe2e5edf191f3bdb498fa7d0">NET_SNMP_MIB_OID0</a>(1,3), 6, 1, 2, 1, 1, 3, 0},</div>
<div class="line">    4, &amp;snmp_SysUpTime,</div>
<div class="line">    NULL },</div>
<div class="line">    ..</div>
<div class="line">}</div>
</div><!-- fragment --><p> In the following example, we will construct a MIB variable entry <b>LedOut</b>. It will allow the SNMP Manager to control LEDs on an evaluation board.</p>
<p>The MIB variable <b>type</b> is Integer. An uint8_t variable is sufficient, because the LED port is 8-bit: </p>
<div class="fragment"><div class="line"><span class="comment">// LedOut Entry</span></div>
<div class="line">{ <a class="code" href="rl__net__ds_8h.html#a3331bd3d72927ae1ce71898ac8a5250f">NET_SNMP_MIB_INTEGER</a>,</div>
</div><!-- fragment --><p>The OID reference is 1.3.6.1.3.1.0. It is defined in the <b>Experimental</b> MIB branch of the MIB tree: </p>
<div class="fragment"><div class="line">6, {<a class="code" href="rl__net__ds_8h.html#aa4f513d3fe2e5edf191f3bdb498fa7d0">NET_SNMP_MIB_OID0</a>(1,3), 6, 1, 3, 1, 0},</div>
</div><!-- fragment --><ul>
<li>the first byte defines the <b>length</b> of the OID name,</li>
<li>macro <b>NET_SNMP_MIB_OID0</b> calculates the first byte of OID value from 1st and 2nd address byte,</li>
<li>the value of an OID address byte must be less than 128, otherwise an <b>extended</b> encoding must be used.</li>
</ul>
<p>The variable size and location is described with the help of <b>NET_SNMP_MIB_INT</b> macro: </p>
<div class="fragment"><div class="line"><a class="code" href="rl__net__ds_8h.html#a8e69467d6fabcce6c6edcef778e45465">NET_SNMP_MIB_INT</a>(LedOut),</div>
</div><!-- fragment --><p> The following macros are defined: </p>
<table class="doxtable">
<tr>
<th>Macro </th><th>Variable Definition  </th></tr>
<tr>
<td>NET_SNMP_MIB_STR </td><td>Octet String size and location. </td></tr>
<tr>
<td>NET_SNMP_MIB_INT </td><td>Signed or Unsigned Integer size and location. </td></tr>
<tr>
<td>NET_SNMP_MIB_IP </td><td>IP Address size and location. </td></tr>
</table>
<p>The <b>write_leds</b> is specified as callback function. It gets called when the <b>LedOut</b> is written: </p>
<div class="fragment"><div class="line">write_leds },</div>
</div><!-- fragment --><p>Finally we need the actual variable definition: </p>
<div class="fragment"><div class="line"><span class="keyword">static</span> uint8_t LedOut;</div>
</div><!-- fragment --><p>For the <b>LedOut</b> control we actually need the following parts of code to be defined in <b>SNMP_Agent_MIB.c</b> module: </p>
<div class="fragment"><div class="line"><span class="keyword">static</span> uint8_t LedOut;</div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> write_leds (int32_t mode);</div>
<div class="line"> </div>
<div class="line"><span class="keyword">const</span> <a class="code" href="group__snmp__structs.html#struct_n_e_t___s_n_m_p___m_i_b___i_n_f_o">NET_SNMP_MIB_INFO</a> snmp_mib[] = {</div>
<div class="line">    ..</div>
<div class="line">  <span class="comment">// LedOut Entry</span></div>
<div class="line">  { <a class="code" href="rl__net__ds_8h.html#a3331bd3d72927ae1ce71898ac8a5250f">NET_SNMP_MIB_INTEGER</a>,</div>
<div class="line">    6, {<a class="code" href="rl__net__ds_8h.html#aa4f513d3fe2e5edf191f3bdb498fa7d0">NET_SNMP_MIB_OID0</a>(1,3), 6, 1, 3, 1, 0},</div>
<div class="line">    <a class="code" href="rl__net__ds_8h.html#a8e69467d6fabcce6c6edcef778e45465">NET_SNMP_MIB_INT</a>(LedOut),</div>
<div class="line">    write_leds },</div>
<div class="line">    ..</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> write_leds (int32_t mode) {</div>
<div class="line">  <span class="comment">// No action on read access.</span></div>
<div class="line">  <span class="keywordflow">if</span> (mode == <a class="code" href="rl__net__ds_8h.html#ae8095e763f09c922ebc43292528c2786">NET_SNMP_MIB_WRITE</a>) {</div>
<div class="line">    LED_SetOut (LedOut);</div>
<div class="line">  }</div>
<div class="line">}</div>
</div><!-- fragment --><h2>Extended OID Encoding </h2>
<p>The value of OID address byte must be less than <b>128</b>. If it is not, an OID address must be encoded in extended format. This is because the high bit of an address byte is an address <b>extension bit</b>.</p>
<p>For example, the OID address 1.3.6.1.4.1.<b>311</b>.0 is encoded as: </p>
<div class="fragment"><div class="line">8, {<a class="code" href="rl__net__ds_8h.html#aa4f513d3fe2e5edf191f3bdb498fa7d0">NET_SNMP_MIB_OID0</a>(1,3), 6, 1, 4, 1, 130, 55, 0},</div>
</div><!-- fragment --><p>The address value for the highlighted numbers is calculated as: </p>
<div class="fragment"><div class="line">(130-128) * 128 + 55 = 311</div>
</div><!-- fragment --><p>The OID address 1.3.6.1.4.1.<b>31036</b>.50.1.1.0 is encoded as: </p>
<div class="fragment"><div class="line">12, {<a class="code" href="rl__net__ds_8h.html#aa4f513d3fe2e5edf191f3bdb498fa7d0">NET_SNMP_MIB_OID0</a>(1,3), 6, 1, 4, 1, 129, 242, 60, 50, 1, 1, 0},</div>
</div><!-- fragment --><p>where the value 31036 is calculated as: </p>
<div class="fragment"><div class="line">(129-128) * 128 * 128 + (242-128) * 128 + 60 = 31036</div>
</div><!-- fragment --> </div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Tue May 25 2021 13:57:38 for Network Component by ARM Ltd. All rights reserved.
	<!--
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.6 
	-->
	</li>
  </ul>
</div>
</body>
</html>
