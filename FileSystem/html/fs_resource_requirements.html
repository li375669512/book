<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>Resource Requirements</title>
<title>File System Component: Resource Requirements</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="drv.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="printComponentTabs.js"></script>
<script type="text/javascript" src="URL_keys.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="stylsheetf" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 46px;">
  <td id="projectlogo"><img alt="Logo" src="keilarm.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">File System Component
   &#160;<span id="projectnumber">Version 6.14.1</span>
   </div>
   <div id="projectbrief">MDK Middleware for Devices with Flash File System</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<div id="DRVnav" class="tabs1">
    <ul class="tablist">
      <script type="text/javascript">
		<!--
		writeComponentTabs.call(this);
		//-->
      </script>
	  </ul>
</div>
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Usage&#160;and&#160;Description</span></a></li>
      <li><a href="modules.html"><span>Reference</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('fs_resource_requirements.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Resource Requirements </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>This section describes the resource requirements of the <b>File System</b> component. The actual requirements depend on the features used in the application. Therefore, the numbers provided here are guidelines only and the actual numbers may differ.</p>
<h1><a class="anchor" id="fs_stack_req"></a>
Stack Requirements</h1>
<p>The File System component receives events sent from the interrupt service routine (ISR) of the drivers of the different drives. The stack requirements for the ISR are typically less than 512 Bytes. The stack requirements for ISR are configured in the <script>link_ext('startup_device');</script> file located under the <b>Device</b> component class.</p>
<table class="doxtable">
<tr>
<th align="left">Option (under section Stack Configuration) </th><th align="left">Increase Value by  </th></tr>
<tr>
<td align="left">Stack Size (in Bytes) </td><td align="left">+ 512 for Driver of a Drive </td></tr>
</table>
<dl class="section note"><dt>Note</dt><dd><ul>
<li>When using a CMSIS-RTOS, the Stack Size in the startup_<em>device</em>.s file configures only the stack space that is used by exception and interrupt service routines of the drivers. The stack size requirements depend on the maximum nesting of exception and ISR execution and therefore on the priority settings of the various interrupt and exception sources.</li>
<li>If you have multiple drives configured in your system with the same interrupt priority, you only need to add the stack of the drive with the largest requirement. If you have drives with nested interrupts (different priorities), you need to add the sum of all stack requirements.</li>
</ul>
</dd></dl>
<h1><a class="anchor" id="fs_heap_req"></a>
Heap Requirements</h1>
<p>Heap is used by memory allocation functions. It is also configured in the <script>link_ext('startup_device');</script> file located under the <b>Device</b> component class. For every simultaneously opened file, you need to configure 512 + 96 Bytes of additional heap. If you wish to have three files open simultaneously, you need to configure an additional heap size of 3 x (512 + 96) Bytes.</p>
<table class="doxtable">
<tr>
<th align="left">Option (under section Heap Configuration) </th><th align="left">Increase Value by  </th></tr>
<tr>
<td align="left">Heap Size (in Bytes) </td><td align="left">+ (512 + 96) for each open file </td></tr>
</table>
<h1><a class="anchor" id="fs_rtos_req"></a>
CMSIS-RTOS Requirements</h1>
<h2>Thread Stack Requirements </h2>
<p>Although the File System component requires a CMSIS-RTOS to be present, it is not creating any additional threads.</p>
<p><b>Using CMSIS-RTOS RTX v5</b></p>
<p>The calling thread can no longer be <code>main</code> but can be a thread with a default stack size (dynamic memory) or a thread with a complete stack or only stack size provided using <code>osThreadAttr_t</code> structure (static or dynamic memory).</p>
<p><b>Using CMSIS-RTOS RTX v4</b></p>
<p>For proper operation, you need to add a certain amount of thread stack size to the calling thread. This calling thread can be the <code>main</code> thread, a thread with a default stack size or a thread with a user provided stack size. For the additional required stack size, please refer to the following table:</p>
<table  class="doxtable" summary="Memory Requirements">
<tr>
<th>Drive Type </th><th align="left">Value  </th></tr>
<tr>
<td align="center">RAM </td><td>min. 0.6 kBytes  </td></tr>
<tr>
<td align="center">MCI </td><td>min. 0.7 kBytes + MCI Driver  </td></tr>
<tr>
<td align="center">NAND </td><td>min. 1.3 kBytes + NAND Driver  </td></tr>
<tr>
<td align="center">NOR </td><td>min. 0.4 kBytes + Flash Driver  </td></tr>
<tr>
<td align="center">USB </td><td>min. 1.1 kBytes + USB Driver  </td></tr>
</table>
<dl class="section note"><dt>Note</dt><dd><ul>
<li>The stack in bytes stated is required to work with the files from top level functions like fopen, fclose, â€¦, fdelete, frename and so on.</li>
<li>The drivers for the different types of drives require additional stack. This differs from device to device, but in general the stack usage for MCI, NAND, and Flash should not exceed additional 100 bytes. Refer to <script>link_ext('USB-Resource-Req');</script> for details.</li>
<li>If your application supports a combination of multiple drives, you need to configure your system to the the combined stack size for the sum of all drives.</li>
</ul>
</dd></dl>
<p>The thread requirements need to be reflected in the CMSIS-RTOS configuration. Refer to the <b>Reference</b> section of <script>link_ext('CMSIS-RTOS1');</script> for further details.</p>
<p>For <script>link_ext('CMSIS-RTX5');</script>, the threads requirements are configured in the <script>link_ext('RTX-Conf-CM5');</script> file located under the <b>CMSIS</b> component class:</p>
<table  class="doxtable" summary="CMSIS-RTOS Configuration">
<tr>
<th align="left">Option (under section Thread Configuration) </th><th>Increase Value by  </th></tr>
<tr>
<td>Default Thread stack size [bytes] </td><td>Stack size from table above  </td></tr>
<tr>
<td align="center" colspan="2"><b>or</b>  </td></tr>
<tr>
<td>Main Thread stack size [bytes] </td><td>Stack size from table above  </td></tr>
<tr>
<td align="center" colspan="2"><b>or</b>  </td></tr>
<tr>
<td>Total stack size [bytes]for threads with user-provided stack size </td><td>Stack size from table above  </td></tr>
</table>
<h2>Mutex Requirements </h2>
<p>Additionally, you may also need to adjust the number of mutex objects required by the C stdio library. Total number of mutex objects required for proper operation is as follows:</p>
<ul>
<li>2 (internal stdio operations) + 3 (stdin, stdout and stderr file streams) + 1 for each active file stream</li>
</ul>
<p><b>Using CMSIS-RTOS RTX v5</b></p>
<p>Memory for mutex objects is allocated from the dynamic memory pool (RTX_Config.h - System Configuration - Global Dynamic Memory size [bytes]). The size of dynamic memory pool must be configured so that the control blocks for the mutexes mentioned above fit inside. The size of a control block for a mutex depends on the RTOS2 implementation. For RTX5 can be found in rtx_os.h and is equal to the size of <code>osRtxMutex_t</code>.</p>
<p><b>Using CMSIS-RTOS RTX v4</b></p>
<p>The number of mutex objects required by stdio library is configured in the <script>link_ext('RTX-Conf-CM4');</script> file located under the <b>CMSIS</b> component class.</p>
<dl class="section note"><dt>Note</dt><dd><ul>
<li>This configuration option is not available from the Configuration Wizard, it must be modified manually.</li>
<li>Default setting allows three concurrent open files and must be adjusted if this is below application requirement.</li>
<li>If you have not enough mutexes available for your application, <a class="el" href="group__stdio__routines.html#ga76a21223ed39a2692fdfc854aab93b2c">fopen</a> will end up blocking in function _mutex_initialize(), supplied by <script>link_ext('CMSIS-RTX5');</script>.</li>
</ul>
</dd></dl>
<table class="doxtable">
<tr>
<th align="left">Definition (under section Standard library system mutexes) </th><th align="left">Set value to  </th></tr>
<tr>
<td align="left">OS_MUTEXCNT </td><td align="left">5 + 1 for each open file </td></tr>
</table>
<h1><a class="anchor" id="fs_spec_mem_req"></a>
Memory Requirements</h1>
<p>The following table shows the memory requirements for read-only (Flash) and read-write (RAM) memory. These numbers may be used to estimate the total size requirements of the application, but the actual numbers depend on compiler optimizations and target processor and may be therefore slightly different.</p>
<table class="doxtable">
<tr>
<th align="left">Component </th><th align="center">RO Memory [Bytes] </th><th align="left">RW Memory (Data) [Bytes]  </th></tr>
<tr>
<td align="left"><b>C stdio Library</b> </td><td align="center">&lt; 5.0 k </td><td align="left">&lt; 0.3 k </td></tr>
<tr>
<td align="left"><b>::File System:Core</b> Common </td><td align="center">&lt; 3.5 k </td><td align="left">0 </td></tr>
<tr>
<td align="left"><b>::File System:Core</b> EFS (Embedded File System) </td><td align="center">&lt; 6.0 k </td><td align="left">&lt; 0.4 k </td></tr>
<tr>
<td align="left"><b>::File System:Core</b> FAT with SFN (Short File Name) </td><td align="center">&lt; 13.0 k </td><td align="left">1.2 k </td></tr>
<tr>
<td align="left"><b>::File System:Core</b> FAT with LFN (Long File Name) </td><td align="center">&lt; 14.4 k </td><td align="left">1.2 k </td></tr>
<tr>
<td align="left"><b>::File System:Core</b> FAT Name caching </td><td align="center">1.6 k </td><td align="left">48 * <em>FAT Name Cache Size</em> (configured in FS_Config_<em>Drive</em>_<em>n</em>.h) </td></tr>
<tr>
<td align="left"><b>::File System:Core</b> FAT Journaling </td><td align="center">0.7 k </td><td align="left">0.5 k (configured in FS_Config_<em>Drive</em>_<em>n</em>.h) </td></tr>
<tr>
<td align="left"><b>::File System:Drive:Memory Card</b> (FAT) </td><td align="center">2.7 k </td><td align="left">&lt; 0.2 k + <em>Drive Cache Size</em> (configured in FS_Config_MC_<em>n</em>.h) </td></tr>
<tr>
<td align="left"><b>::File System:Drive:NAND</b> (FAT) </td><td align="center">&lt; 10.6 k </td><td align="left">&lt; 0.7 k + <em>Drive Cache Size</em> + <em>Page Caching</em> + <em>Block Indexing</em> (configured in FS_Config_NAND_<em>n</em>.h) </td></tr>
<tr>
<td align="left"><b>::File System:Drive:NOR</b> (EFS) </td><td align="center">&lt; 0.1 k </td><td align="left">&lt; 0.1 k </td></tr>
<tr>
<td align="left"><b>::File System:Drive:RAM</b> (FAT) </td><td align="center">&lt; 0.2 k </td><td align="left">&lt; 0.2 k </td></tr>
<tr>
<td align="left"><b>::File System:Drive:USB</b> (FAT) </td><td align="center">&lt; 0.6 k </td><td align="left">&lt; 0.2 k + <em>Drive Cache Size</em> (configured in FS_Config_USB_<em>n</em>.h) </td></tr>
<tr>
<td align="left"><b>MCI Driver</b> </td><td align="center">1 .. 4 k </td><td align="left">0.1 .. 2 k </td></tr>
<tr>
<td align="left"><b>NAND Driver</b> </td><td align="center">0.5 .. 4 k </td><td align="left">0.1 .. 4 k </td></tr>
<tr>
<td align="left"><b>Flash Driver</b> </td><td align="center">&lt; 2 k </td><td align="left">&lt; 0.1 k </td></tr>
</table>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Tue May 25 2021 13:57:20 for File System Component by ARM Ltd. All rights reserved.
	<!--
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.6 
	-->
	</li>
  </ul>
</div>
</body>
</html>
