<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>HTTP Web Server</title>
<title>Network Component: HTTP Web Server</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="drv.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="printComponentTabs.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="stylsheetf" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 46px;">
  <td id="projectlogo"><img alt="Logo" src="keilarm.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">Network Component
   &#160;<span id="projectnumber">Version 6.7.7</span>
   </div>
   <div id="projectbrief">MDK-Professional Middleware for IP Networking</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<div id="DRVnav" class="tabs1">
    <ul class="tablist">
      <script type="text/javascript">
		<!--
		writeComponentTabs.call(this);
		//-->
      </script>
	  </ul>
</div>
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Usage&#160;and&#160;Description</span></a></li>
      <li><a href="modules.html"><span>Reference</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('group__net__http_func.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">HTTP Web Server<div class="ingroups"><a class="el" href="group__net__services.html">Services</a></div></div>  </div>
</div><!--header-->
<div class="contents">

<p>HTTP Web Server routines are used to run and configure services of the built-in web server.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga35b6f62f47735bb08ba5261522b87b9e"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__net__http_func.html#ga35b6f62f47735bb08ba5261522b87b9e">http_check_account</a> (const char *username, const char *password)</td></tr>
<tr class="memdesc:ga35b6f62f47735bb08ba5261522b87b9e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check if an user account exist in the user database.  <a href="#ga35b6f62f47735bb08ba5261522b87b9e">More...</a><br/></td></tr>
<tr class="separator:ga35b6f62f47735bb08ba5261522b87b9e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga8979e7080cfe548f33ec5a377ce5cfd8"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__net__http_func.html#ga8979e7080cfe548f33ec5a377ce5cfd8">http_get_user_id</a> (void)</td></tr>
<tr class="memdesc:ga8979e7080cfe548f33ec5a377ce5cfd8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Retrieve the user identification.  <a href="#ga8979e7080cfe548f33ec5a377ce5cfd8">More...</a><br/></td></tr>
<tr class="separator:ga8979e7080cfe548f33ec5a377ce5cfd8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga5a4b5fea162e7fecf7de6a9672ceeb3f"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__net__http_func.html#ga5a4b5fea162e7fecf7de6a9672ceeb3f">http_accept_client</a> (const uint8_t *ip_addr, uint16_t port)</td></tr>
<tr class="memdesc:ga5a4b5fea162e7fecf7de6a9672ceeb3f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Accept or deny connection from remote HTTP client.  <a href="#ga5a4b5fea162e7fecf7de6a9672ceeb3f">More...</a><br/></td></tr>
<tr class="separator:ga5a4b5fea162e7fecf7de6a9672ceeb3f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga34d2f0e562a5e226704ac38ed14a01e7"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__net__http_func.html#ga34d2f0e562a5e226704ac38ed14a01e7">http_file_access</a> (uint8_t user_id, const char *fname)</td></tr>
<tr class="memdesc:ga34d2f0e562a5e226704ac38ed14a01e7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check if remote user is allowed to access a file on HTTP server.  <a href="#ga34d2f0e562a5e226704ac38ed14a01e7">More...</a><br/></td></tr>
<tr class="separator:ga34d2f0e562a5e226704ac38ed14a01e7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga44887ab206ed6b707fbc526f2e09048d"><td class="memItemLeft" align="right" valign="top">char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__net__http_func.html#ga44887ab206ed6b707fbc526f2e09048d">http_server_fgets</a> (void *file, char *buf, uint32_t size)</td></tr>
<tr class="memdesc:ga44887ab206ed6b707fbc526f2e09048d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Read a string from a file in HTTP server.  <a href="#ga44887ab206ed6b707fbc526f2e09048d">More...</a><br/></td></tr>
<tr class="separator:ga44887ab206ed6b707fbc526f2e09048d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga7f28c5595361d3d16decb4f5e0b6cd8e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__net__http_func.html#ga7f28c5595361d3d16decb4f5e0b6cd8e">http_server_fclose</a> (void *file)</td></tr>
<tr class="memdesc:ga7f28c5595361d3d16decb4f5e0b6cd8e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Close a file previously open in HTTP server.  <a href="#ga7f28c5595361d3d16decb4f5e0b6cd8e">More...</a><br/></td></tr>
<tr class="separator:ga7f28c5595361d3d16decb4f5e0b6cd8e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gae141878f0b5761ae1678e8095050510f"><td class="memItemLeft" align="right" valign="top">void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__net__http_func.html#gae141878f0b5761ae1678e8095050510f">http_server_fopen</a> (const char *fname)</td></tr>
<tr class="memdesc:gae141878f0b5761ae1678e8095050510f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Open a file for reading in HTTP server.  <a href="#gae141878f0b5761ae1678e8095050510f">More...</a><br/></td></tr>
<tr class="separator:gae141878f0b5761ae1678e8095050510f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga4b6205c88569381be8c810b4e3aa2226"><td class="memItemLeft" align="right" valign="top">uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__net__http_func.html#ga4b6205c88569381be8c810b4e3aa2226">http_server_fread</a> (void *file, uint8_t *buf, uint32_t len)</td></tr>
<tr class="memdesc:ga4b6205c88569381be8c810b4e3aa2226"><td class="mdescLeft">&#160;</td><td class="mdescRight">Read block of data from a file in HTTP server.  <a href="#ga4b6205c88569381be8c810b4e3aa2226">More...</a><br/></td></tr>
<tr class="separator:ga4b6205c88569381be8c810b4e3aa2226"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga7d1f7422e7e08679c48ce944db49647a"><td class="memItemLeft" align="right" valign="top">uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__net__http_func.html#ga7d1f7422e7e08679c48ce944db49647a">http_server_ftime</a> (const char *fname)</td></tr>
<tr class="memdesc:ga7d1f7422e7e08679c48ce944db49647a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Retrieve last modification time of a file.  <a href="#ga7d1f7422e7e08679c48ce944db49647a">More...</a><br/></td></tr>
<tr class="separator:ga7d1f7422e7e08679c48ce944db49647a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga3915d89170929c7ca5a32d2fbfac5804"><td class="memItemLeft" align="right" valign="top">uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__net__http_func.html#ga3915d89170929c7ca5a32d2fbfac5804">http_utc_time</a> (uint8_t hr, uint8_t min, uint8_t sec, uint8_t day, uint8_t mon, uint16_t year)</td></tr>
<tr class="memdesc:ga3915d89170929c7ca5a32d2fbfac5804"><td class="mdescLeft">&#160;</td><td class="mdescRight">Convert generic time to UTC time format.  <a href="#ga3915d89170929c7ca5a32d2fbfac5804">More...</a><br/></td></tr>
<tr class="separator:ga3915d89170929c7ca5a32d2fbfac5804"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga6f2f9fb059e4d34ee12a93582bfd7ed3"><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__net__http_func.html#ga6f2f9fb059e4d34ee12a93582bfd7ed3">http_get_env_var</a> (const char *env, char *ansi, uint32_t maxlen)</td></tr>
<tr class="memdesc:ga6f2f9fb059e4d34ee12a93582bfd7ed3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Process environment variables and convert to ANSI format.  <a href="#ga6f2f9fb059e4d34ee12a93582bfd7ed3">More...</a><br/></td></tr>
<tr class="separator:ga6f2f9fb059e4d34ee12a93582bfd7ed3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga940b475ffc39fc39ec692b536106dc47"><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__net__http_func.html#ga940b475ffc39fc39ec692b536106dc47">http_server_get_content_type</a> (void)</td></tr>
<tr class="memdesc:ga940b475ffc39fc39ec692b536106dc47"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get Content-Type HTML header, received in XML post request.  <a href="#ga940b475ffc39fc39ec692b536106dc47">More...</a><br/></td></tr>
<tr class="separator:ga940b475ffc39fc39ec692b536106dc47"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga9de72e43415a12fe5aff144921d0eb4f"><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__net__http_func.html#ga9de72e43415a12fe5aff144921d0eb4f">http_server_get_lang</a> (void)</td></tr>
<tr class="memdesc:ga9de72e43415a12fe5aff144921d0eb4f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Retrieve the preferred language setting from the browser.  <a href="#ga9de72e43415a12fe5aff144921d0eb4f">More...</a><br/></td></tr>
<tr class="separator:ga9de72e43415a12fe5aff144921d0eb4f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gafe5c5a991a4d01baf11ef291a5c6ef6a"><td class="memItemLeft" align="right" valign="top">int32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__net__http_func.html#gafe5c5a991a4d01baf11ef291a5c6ef6a">http_server_get_session</a> (void)</td></tr>
<tr class="memdesc:gafe5c5a991a4d01baf11ef291a5c6ef6a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get current session number of HTTP server.  <a href="#gafe5c5a991a4d01baf11ef291a5c6ef6a">More...</a><br/></td></tr>
<tr class="separator:gafe5c5a991a4d01baf11ef291a5c6ef6a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga8afdc0440fb17b82d62e7e788d29d4ad"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__status__error__codes__net.html#ga5675a3b88ee02986ae15ae3bb8135551">netStatus</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__net__http_func.html#ga8afdc0440fb17b82d62e7e788d29d4ad">http_server_get_client</a> (uint8_t *ip_addr, uint8_t *mac_addr)</td></tr>
<tr class="memdesc:ga8afdc0440fb17b82d62e7e788d29d4ad"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get IP and MAC address of connected remote machine.  <a href="#ga8afdc0440fb17b82d62e7e788d29d4ad">More...</a><br/></td></tr>
<tr class="separator:ga8afdc0440fb17b82d62e7e788d29d4ad"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gad489f3562d1482e32ffa11f8045333cb"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__net__http_func.html#gad489f3562d1482e32ffa11f8045333cb">cgi_process_data</a> (uint8_t code, const char *data, uint32_t len)</td></tr>
<tr class="memdesc:gad489f3562d1482e32ffa11f8045333cb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Process data received by POST request.  <a href="#gad489f3562d1482e32ffa11f8045333cb">More...</a><br/></td></tr>
<tr class="separator:gad489f3562d1482e32ffa11f8045333cb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga344e2edc2397fa27fd78354c27312bcc"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__net__http_func.html#ga344e2edc2397fa27fd78354c27312bcc">cgi_process_query</a> (const char *qstr)</td></tr>
<tr class="memdesc:ga344e2edc2397fa27fd78354c27312bcc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Process query string received by GET request.  <a href="#ga344e2edc2397fa27fd78354c27312bcc">More...</a><br/></td></tr>
<tr class="separator:ga344e2edc2397fa27fd78354c27312bcc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga977b2d34678313ddbc047fd4f5b2e55b"><td class="memItemLeft" align="right" valign="top">uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__net__http_func.html#ga977b2d34678313ddbc047fd4f5b2e55b">cgi_script</a> (const char *env, char *buf, uint32_t buflen, uint32_t *pcgi)</td></tr>
<tr class="memdesc:ga977b2d34678313ddbc047fd4f5b2e55b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generate dynamic web data from a script line.  <a href="#ga977b2d34678313ddbc047fd4f5b2e55b">More...</a><br/></td></tr>
<tr class="separator:ga977b2d34678313ddbc047fd4f5b2e55b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga02f70cae306d0b4bb29c49d2d637ae66"><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__net__http_func.html#ga02f70cae306d0b4bb29c49d2d637ae66">cgi_content_type</a> (const char *file_ext)</td></tr>
<tr class="memdesc:ga02f70cae306d0b4bb29c49d2d637ae66"><td class="mdescLeft">&#160;</td><td class="mdescRight">Add custom MIME type for unsupported file types.  <a href="#ga02f70cae306d0b4bb29c49d2d637ae66">More...</a><br/></td></tr>
<tr class="separator:ga02f70cae306d0b4bb29c49d2d637ae66"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga092702be389b4b1aa5dff5d00b2a4841"><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__net__http_func.html#ga092702be389b4b1aa5dff5d00b2a4841">cgx_content_type</a> (void)</td></tr>
<tr class="memdesc:ga092702be389b4b1aa5dff5d00b2a4841"><td class="mdescLeft">&#160;</td><td class="mdescRight">Override default Content-Type for CGX script files.  <a href="#ga092702be389b4b1aa5dff5d00b2a4841">More...</a><br/></td></tr>
<tr class="separator:ga092702be389b4b1aa5dff5d00b2a4841"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga3640efd81eebd825d238d153407d52a2"><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__net__http_func.html#ga3640efd81eebd825d238d153407d52a2">http_encoding</a> (void)</td></tr>
<tr class="memdesc:ga3640efd81eebd825d238d153407d52a2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Override default character encoding in html documents.  <a href="#ga3640efd81eebd825d238d153407d52a2">More...</a><br/></td></tr>
<tr class="separator:ga3640efd81eebd825d238d153407d52a2"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Description</h2>
<p>HTTP Web Server routines are used to run and configure services of the built-in web server. </p>
<p>A web server is used to host websites and to deliver the web pages to clients using the <b>Hypertext Transfer Protocol</b>. There are two types of web pages which are stored on a web server and sent to a web client on request:</p>
<ul>
<li>Static Web pages do not change their content. When the page is requested, it is sent to the web client as it is. It is not modified.</li>
<li>Dynamic Web pages are generated when the page is requested. Pages that show system settings or log records are examples of dynamic pages.</li>
</ul>
<p>The Network Component's HTTP server supports both types of web pages. Static web pages are generally stored in the virtual ROM file system. The files are converted into C-code by the <a href="http://www.keil.com/support/man/docs/uv4/uv4_ut_fcarmuv.htm" class="el" target="_blank">FCARM</a> file converter and compiled into code.</p>
<h2>Supported Features and Technologies </h2>
<p>The Web Server supports the usage of many advanced web technologies:</p>
<ul>
<li>A <a class="el" href="using_http_server.html#ws_script_langugage">Script Language</a> is used to generate dynamic web pages.</li>
<li><a class="el" href="using_http_server.html#ws_ajax">AJAX Programming</a> is used to create web-applications that are processed on the client-side, thus unloading the web server.</li>
<li><a class="el" href="using_http_server.html#ws_soap">SOAP Support</a> is necessary for modern user interfaces.</li>
<li><a class="el" href="using_http_server.html#ws_http_caching">HTTP Caching</a> enables local caching in the browser and improves the Web Server performance a lot.</li>
<li><a class="el" href="using_http_server.html#ws_web_on_sd">HTTP File Upload</a> allows you to store the complete web site on SD card. The files can be updated via the web interface. This feature is only available with the <b>Full Web Server</b>.</li>
<li><a class="el" href="using_http_server.html#ws_access_filtering">Access Filtering</a> allows you to filter out the hosts, which are not allowed to connect to the Web Server.</li>
<li><a class="el" href="using_http_server.html#ws_multilingo">Multi-language Web Pages</a> can be generated with the help of the integrated <a class="el" href="using_http_server.html#ws_script_langugage">Script Language</a>.</li>
<li><a class="el" href="using_http_server.html#ws_multiuser">Multi-user Web Authentication</a> allows you to manage user accounts and access rights for each user.</li>
</ul>
<dl class="section note"><dt>Note</dt><dd>The page <a class="el" href="using_http_server.html">HTTP Web Server</a> gives you more information on the actual usage of the functions and how to work with them in a project.</dd></dl>
<h2>Code Examples </h2>
<h3>HTTP Server CGI Template</h3>
<p>The following source code is part of the <b>HTTP_Server_CGI.c</b> template file. The application specific behaviour of the <a class="el" href="using_http_server.html#ws_script_langugage">Script Language</a> may be implemented using this code template: <a class="anchor" id="anchor_HTTP_Server_CGI"></a></p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;stdio.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;string.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="rl__net_8h.html">rl_net.h</a>&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// Process query string received by GET request.</span></div>
<div class="line"><span class="keywordtype">void</span> <a class="code" href="group__net__http_func.html#ga344e2edc2397fa27fd78354c27312bcc">cgi_process_query</a> (<span class="keyword">const</span> <span class="keywordtype">char</span> *qstr) {</div>
<div class="line">  <span class="keywordtype">char</span> var[40];</div>
<div class="line"></div>
<div class="line">  <span class="keywordflow">do</span> {</div>
<div class="line">    <span class="comment">// Loop through all the parameters</span></div>
<div class="line">    qstr = <a class="code" href="group__net__http_func.html#ga6f2f9fb059e4d34ee12a93582bfd7ed3">http_get_env_var</a> (qstr, var, <span class="keyword">sizeof</span> (var));</div>
<div class="line">    <span class="comment">// Check return string, &#39;qstr&#39; now points to the next parameter</span></div>
<div class="line">    <span class="keywordflow">if</span> (var[0] != 0) {</div>
<div class="line">      <span class="comment">// First character is non-null, string exists</span></div>
<div class="line"></div>
<div class="line">      <span class="comment">/* Example of a parameter &quot;ip=192.168.0.100&quot;</span></div>
<div class="line"><span class="comment">      if (strncmp (var, &quot;ip=&quot;, 3) == 0) {</span></div>
<div class="line"><span class="comment">        uint8_t ip_addr[IP4_ADDR_LEN];</span></div>
<div class="line"><span class="comment">        // Read parameter IP address submitted by the browser</span></div>
<div class="line"><span class="comment">        ip4_aton (&amp;var[3], ip_addr);</span></div>
<div class="line"><span class="comment">         ...</span></div>
<div class="line"><span class="comment">      }</span></div>
<div class="line"><span class="comment">      */</span></div>
<div class="line">    }</div>
<div class="line">  } <span class="keywordflow">while</span> (qstr);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Process data received by POST request.</span></div>
<div class="line"><span class="comment">// Type code: - 0 = www-url-encoded form data.</span></div>
<div class="line"><span class="comment">//            - 1 = filename for file upload (null-terminated string).</span></div>
<div class="line"><span class="comment">//            - 2 = file upload raw data.</span></div>
<div class="line"><span class="comment">//            - 3 = end of file upload (file close requested).</span></div>
<div class="line"><span class="comment">//            - 4 = any other type of POST data (single or last stream).</span></div>
<div class="line"><span class="comment">//            - 5 = the same as 4, but with more data to follow.</span></div>
<div class="line"><span class="keywordtype">void</span> <a class="code" href="group__net__http_func.html#gad489f3562d1482e32ffa11f8045333cb">cgi_process_data</a> (uint8_t code, <span class="keyword">const</span> <span class="keywordtype">char</span> *data, uint32_t len) {</div>
<div class="line">  <span class="keywordtype">char</span> var[40];</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">switch</span> (code) {</div>
<div class="line">    <span class="keywordflow">case</span> 0:</div>
<div class="line">      <span class="comment">// Url encoded form data received</span></div>
<div class="line">      <span class="keywordflow">do</span> {</div>
<div class="line">        <span class="comment">// Parse all parameters</span></div>
<div class="line">        data = <a class="code" href="group__net__http_func.html#ga6f2f9fb059e4d34ee12a93582bfd7ed3">http_get_env_var</a> (data, var, <span class="keyword">sizeof</span> (var));</div>
<div class="line">        <span class="keywordflow">if</span> (var[0] != 0) {</div>
<div class="line">          <span class="comment">// First character is non-null, string exists</span></div>
<div class="line">          <span class="comment">/* Example</span></div>
<div class="line"><span class="comment">          if (strcmp (var, &quot;led0=on&quot;) == 0) {</span></div>
<div class="line"><span class="comment">            // ... Switch LED 0 on</span></div>
<div class="line"><span class="comment">          }</span></div>
<div class="line"><span class="comment">          */</span></div>
<div class="line">        }</div>
<div class="line">      } <span class="keywordflow">while</span> (data);</div>
<div class="line">      <span class="keywordflow">break</span>;</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">case</span> 1:</div>
<div class="line">      <span class="comment">// Filename for file upload received</span></div>
<div class="line">      <span class="comment">/* Example</span></div>
<div class="line"><span class="comment">      if (data[0] != 0) {</span></div>
<div class="line"><span class="comment">        // Open a file for writing</span></div>
<div class="line"><span class="comment">        file = fopen (var, &quot;w&quot;);</span></div>
<div class="line"><span class="comment">      }</span></div>
<div class="line"><span class="comment">      */</span></div>
<div class="line">      <span class="keywordflow">break</span>;</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">case</span> 2:</div>
<div class="line">      <span class="comment">// File content data received</span></div>
<div class="line">      <span class="comment">/* Example</span></div>
<div class="line"><span class="comment">      if (file != NULL) {</span></div>
<div class="line"><span class="comment">        // Write data to a file</span></div>
<div class="line"><span class="comment">        fwrite (data, 1, len, file);</span></div>
<div class="line"><span class="comment">      }</span></div>
<div class="line"><span class="comment">      */</span></div>
<div class="line">      <span class="keywordflow">break</span>;</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">case</span> 3:</div>
<div class="line">      <span class="comment">// File upload finished</span></div>
<div class="line">      <span class="comment">/* Example</span></div>
<div class="line"><span class="comment">      if (file != NULL) {</span></div>
<div class="line"><span class="comment">        // Close a file</span></div>
<div class="line"><span class="comment">        fclose (file);</span></div>
<div class="line"><span class="comment">      }</span></div>
<div class="line"><span class="comment">      */</span></div>
<div class="line">      <span class="keywordflow">break</span>;</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">case</span> 4:</div>
<div class="line">      <span class="comment">// Other content type data, last packet</span></div>
<div class="line">      <span class="comment">/* Example</span></div>
<div class="line"><span class="comment">      if (strcmp (http_get_content_type(), &quot;text/xml; charset=utf-8&quot; == 0) {</span></div>
<div class="line"><span class="comment">        // Content type xml, utf-8 encoding</span></div>
<div class="line"><span class="comment">         ...</span></div>
<div class="line"><span class="comment">      }</span></div>
<div class="line"><span class="comment">      */</span></div>
<div class="line">      <span class="keywordflow">break</span>;</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">case</span> 5:</div>
<div class="line">      <span class="comment">// Other content type data, more to follow</span></div>
<div class="line">      <span class="comment">// ... Process data</span></div>
<div class="line">      <span class="keywordflow">break</span>;</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">default</span>:</div>
<div class="line">      <span class="comment">// Ignore all other codes</span></div>
<div class="line">      <span class="keywordflow">break</span>;</div>
<div class="line">  }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Generate dynamic web data from a script line.</span></div>
<div class="line">uint32_t <a class="code" href="group__net__http_func.html#ga977b2d34678313ddbc047fd4f5b2e55b">cgi_script</a> (<span class="keyword">const</span> <span class="keywordtype">char</span> *env, <span class="keywordtype">char</span> *buf, uint32_t buflen, uint32_t *pcgi) {</div>
<div class="line">  uint32_t len = 0;</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Analyze a &#39;c&#39; script line starting position 2</span></div>
<div class="line">  <span class="comment">/* Example script</span></div>
<div class="line"><span class="comment">  // c a i &lt;td&gt;&lt;input type=text name=ip value=&quot;%s&quot; size=18 maxlength=18&gt;&lt;/td&gt;</span></div>
<div class="line"><span class="comment"></span></div>
<div class="line"><span class="comment">  switch (env[0]) {</span></div>
<div class="line"><span class="comment">    case &#39;a&#39; :</span></div>
<div class="line"><span class="comment">      switch (env[2]) {</span></div>
<div class="line"><span class="comment">        case &#39;i&#39;:</span></div>
<div class="line"><span class="comment">          // Write the local IP address</span></div>
<div class="line"><span class="comment">          len = sprintf (buf, &amp;env[4], ip4_ntoa (IpAddr));</span></div>
<div class="line"><span class="comment">          break;</span></div>
<div class="line"><span class="comment">          ...</span></div>
<div class="line"><span class="comment">      }</span></div>
<div class="line"><span class="comment">      break;</span></div>
<div class="line"><span class="comment">  }</span></div>
<div class="line"><span class="comment">  */</span></div>
<div class="line">  <span class="keywordflow">return</span> (len);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Override default Content-Type for CGX script files.</span></div>
<div class="line"><span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="group__net__http_func.html#ga092702be389b4b1aa5dff5d00b2a4841">cgx_content_type</a> (<span class="keywordtype">void</span>) {</div>
<div class="line">  <span class="comment">/* Example</span></div>
<div class="line"><span class="comment">  return (&quot;text/xml; charset=utf-8&quot;);</span></div>
<div class="line"><span class="comment">  */</span></div>
<div class="line">  <span class="keywordflow">return</span> (NULL);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Override default character encoding in html documents.</span></div>
<div class="line"><span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="group__net__http_func.html#ga3640efd81eebd825d238d153407d52a2">http_encoding</a> (<span class="keywordtype">void</span>) {</div>
<div class="line">  <span class="comment">/* Example</span></div>
<div class="line"><span class="comment">  return (&quot;utf-8&quot;);</span></div>
<div class="line"><span class="comment">  */</span></div>
<div class="line">  <span class="keywordflow">return</span> (NULL);</div>
<div class="line">}</div>
</div><!-- fragment --> <h3>HTTP Server Multi-User Template</h3>
<p>The following source code is part of the <b>HTTP_Server_Multiuser.c</b> template file, which handles <a class="el" href="using_http_server.html#ws_multiuser">Multi-user Web Authentication</a> for the HTTP server: <a class="anchor" id="anchor_HTTP_Server_Multiuser"></a></p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;string.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="rl__net_8h.html">rl_net.h</a>&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// Check if an user account exist in the user database.</span></div>
<div class="line">uint8_t <a class="code" href="group__net__http_func.html#ga35b6f62f47735bb08ba5261522b87b9e">http_check_account</a> (<span class="keyword">const</span> <span class="keywordtype">char</span> *username, <span class="keyword">const</span> <span class="keywordtype">char</span> *password) {</div>
<div class="line">  <span class="comment">/* Example</span></div>
<div class="line"><span class="comment">  if ((strcmp (username, &quot;guest&quot;) == 0) &amp;&amp; (strcmp (password, &quot;guest&quot;) == 0)) {</span></div>
<div class="line"><span class="comment">    // Accept guest account</span></div>
<div class="line"><span class="comment">    return (1);</span></div>
<div class="line"><span class="comment">  }</span></div>
<div class="line"><span class="comment">  */</span></div>
<div class="line">  <span class="keywordflow">return</span> (0);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Check if remote user is allowed to access a file on HTTP server.</span></div>
<div class="line"><span class="keywordtype">bool</span> <a class="code" href="group__net__http_func.html#ga34d2f0e562a5e226704ac38ed14a01e7">http_file_access</a> (uint8_t user_id, <span class="keyword">const</span> <span class="keywordtype">char</span> *fname) {</div>
<div class="line">  <span class="comment">/* Example</span></div>
<div class="line"><span class="comment">  if (user_id == 1) {</span></div>
<div class="line"><span class="comment">    if (strcmp (fname, &quot;system.cgi&quot;) == 0) {</span></div>
<div class="line"><span class="comment">      // User &quot;guest&quot; is not allowed to see &quot;system.cgi&quot;</span></div>
<div class="line"><span class="comment">      return (false);</span></div>
<div class="line"><span class="comment">    }</span></div>
<div class="line"><span class="comment">  }</span></div>
<div class="line"><span class="comment">  */</span></div>
<div class="line">  <span class="keywordflow">return</span> (<span class="keyword">true</span>);</div>
<div class="line">}</div>
</div><!-- fragment --> <h3>HTTP Server Error Template</h3>
<p>The following source code is part of the <b>HTTP_Server_Error.c</b> template file. Application specific <a class="el" href="using_http_server.html#ws_web_pages">error pages</a> are implemented using this code template: <a class="anchor" id="anchor_HTTP_Server_Error"></a></p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="rl__net__lib_8h.html">rl_net_lib.h</a>&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// Keep HTTP Error page size small</span></div>
<div class="line"><a class="code" href="group__net__internal__system__functions.html#struct_h_t_t_p___e_r_r_o_r">HTTP_ERROR</a> http_error = {</div>
<div class="line">  <span class="comment">// HTTP Error page header</span></div>
<div class="line">  <span class="stringliteral">&quot;&lt;head&gt;&lt;title&gt;Server Error&lt;/title&gt;&lt;/head&gt;&quot;</span></div>
<div class="line">  <span class="stringliteral">&quot;&lt;body&gt;&quot;</span>,</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// HTTP Error page footer</span></div>
<div class="line">  <span class="stringliteral">&quot;&lt;hr&gt;&lt;br&gt;&quot;</span></div>
<div class="line">  <span class="stringliteral">&quot;&lt;i&gt;Keil Embedded WEB Server V2.00, 2013&lt;br&gt;&quot;</span></div>
<div class="line">  <span class="stringliteral">&quot;&lt;a href=http://www.keil.com&gt;www.keil.com&lt;/a&gt;&quot;</span></div>
<div class="line">  <span class="stringliteral">&quot; - Embedded Development Tools&lt;/i&gt;&quot;</span></div>
<div class="line">  <span class="stringliteral">&quot;&lt;/body&gt;&quot;</span>,</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// HTTP Error 401 - Unauthorized access</span></div>
<div class="line">  <span class="stringliteral">&quot;&lt;h2&gt;Error 401 - Unauthorized Access&lt;/h2&gt;&quot;</span></div>
<div class="line">  <span class="stringliteral">&quot;You are not authorized to access this server.&quot;</span>,</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// HTTP Error 403 - Forbidden</span></div>
<div class="line">  <span class="stringliteral">&quot;&lt;h2&gt;Error 403 - Forbidden&lt;/h2&gt;&quot;</span></div>
<div class="line">  <span class="stringliteral">&quot;You don&#39;t have permission to access this resource.&quot;</span>,</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// HTTP Error 404 - Not Found</span></div>
<div class="line">  <span class="stringliteral">&quot;&lt;h2&gt;Error 404 - Not Found&lt;/h2&gt;&quot;</span></div>
<div class="line">  <span class="stringliteral">&quot;The requested URL was not found on this server.&quot;</span>,</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// HTTP Error 501 - Not Implemented</span></div>
<div class="line">  <span class="stringliteral">&quot;&lt;h2&gt;Error 501 - Not Implemented&lt;/h2&gt;&quot;</span></div>
<div class="line">  <span class="stringliteral">&quot;The requested Method is not supported.&quot;</span></div>
<div class="line">};</div>
</div><!-- fragment --><h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="ga02f70cae306d0b4bb29c49d2d637ae66"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char * cgi_content_type </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>file_ext</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Add custom MIME type for unsupported file types. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">file_ext</td><td>filename extension, a null-terminated string. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>pointer to user defined Content-Type or NULL for unknown type.</dd></dl>
<p>The function <b>cgi_content_type</b> allows you to add new MIME types for the Content-Type html header in the response to the web service application requests. The function returns a pointer to the Content-Type html header. You can use this function to add new file types to the Network Component library.</p>
<p>The default content type for unsupported file types is: </p>
<div class="fragment"><div class="line">Content-Type: application/octet-stream\r\n</div>
</div><!-- fragment --><p> This header is used if the file type is not supported in Web server and <b>cgi_content_type</b> function does not exist in the project or if it returns a NULL pointer.</p>
<p>The <b>cgi_content_type</b> function is in the <b>HTTP_Server_CGI.c</b> module. The prototype is defined in <a class="el" href="rl__net_8h.html">rl_net.h</a>.</p>
<dl class="section note"><dt>Note</dt><dd>This function is optional. If missing, or returning NULL, a default content type is used for unsupported file types.</dd></dl>
<p><b>Code Example</b> </p>
<div class="fragment"><div class="line"><span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="group__net__http_func.html#ga02f70cae306d0b4bb29c49d2d637ae66">cgi_content_type</a> (<span class="keyword">const</span> <span class="keywordtype">char</span> *file_ext) {</div>
<div class="line">  <span class="comment">// Example</span></div>
<div class="line">  <span class="keywordflow">if</span> (strcmp (file_ext, <span class="stringliteral">&quot;wav&quot;</span>) == 0) {</div>
<div class="line">    <span class="keywordflow">return</span> (<span class="stringliteral">&quot;audio/wav&quot;</span>);</div>
<div class="line">  }</div>
<div class="line">  <span class="keywordflow">return</span> (NULL);</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
</div>
<a class="anchor" id="gad489f3562d1482e32ffa11f8045333cb"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void cgi_process_data </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>code</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Process data received by POST request. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">code</td><td>callback context:<ul>
<li>0 = www-url-encoded form data,</li>
<li>1 = filename for file upload (null-terminated string),</li>
<li>2 = file upload raw data,</li>
<li>3 = end of file upload (file close requested),</li>
<li>4 = any other type of POST data (single or last stream),</li>
<li>5 = the same as 4, but with more data to follow. </li>
</ul>
</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">data</td><td>pointer to POST data. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">len</td><td>length of POST data. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>none.</dd></dl>
<p>The function <b>cgi_process_data</b> processes the data returned from the POST method of the <a class="el" href="using_http_server.html#ws_script_langugage">CGI</a> form. The HTTP server calls this function when a user clicks the SUBMIT button of an input form.</p>
<p>The argument <em>code</em> can have the following types:</p>
<table class="doxtable">
<tr>
<th>Code</th><th>Data Type </th><th>Meaning of *data </th><th>Meaning of len  </th></tr>
<tr>
<td>0 </td><td>Form data </td><td>Pointer to data string returned from the POST method.</td><td>Length of data string. </td></tr>
<tr>
<td>1 </td><td>Filename </td><td>Pointer to a Filename for the http file upload. Filename is a 0-terminated string.</td><td>Length of a filename. </td></tr>
<tr>
<td>2 </td><td>File data </td><td>Pointer to data packet received from the host.</td><td>Length of data packet. </td></tr>
<tr>
<td>3 </td><td>End of file</td><td>NULL </td><td>Don't care. </td></tr>
<tr>
<td>4 </td><td>Other data </td><td>Pointer to data string returned from the POST method. A single packet or last packet in data stream.</td><td>Length of data string. </td></tr>
<tr>
<td>5 </td><td>Other data </td><td>Pointer to data string returned from the POST method. The same as under 4, but with more data to follow.</td><td>Length of data string. </td></tr>
</table>
<p>The argument <em>data</em> point to the data that get processed. The argument <em>len</em> is the data length in bytes.</p>
<p>The function is in the <b>HTTP_Server_CGI.c</b> module. </p>
<dl class="section note"><dt>Note</dt><dd><ul>
<li>The HTTP server calls the function only if the input form (HTML source) is created with the attribute METHOD=POST. For example: <div class="fragment"><div class="line">&lt;FORM ACTION=index.htm METHOD=POST NAME=CGI&gt;</div>
<div class="line">..</div>
<div class="line">&lt;/FORM&gt;</div>
</div><!-- fragment --></li>
<li>Web browsers provide a filename for HTTP file upload with a path included. It is the user's responsibility to remove the path information from the filename.</li>
<li>For large files, file data is received in several small packets. The size of data packet depends on the TCP Maximum Segment Size (MSS). This value is typically <span class="XML-Token">1460</span> bytes.</li>
<li>The XML-POST is generated from the web service application.</li>
</ul>
</dd></dl>
<p><b>Code Example</b> </p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;stdio.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;string.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="rl__net_8h.html">rl_net.h</a>&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// Process data received by POST request.</span></div>
<div class="line"><span class="comment">// Type code: - 0 = www-url-encoded form data.</span></div>
<div class="line"><span class="comment">//            - 1 = filename for file upload (null-terminated string).</span></div>
<div class="line"><span class="comment">//            - 2 = file upload raw data.</span></div>
<div class="line"><span class="comment">//            - 3 = end of file upload (file close requested).</span></div>
<div class="line"><span class="comment">//            - 4 = any other type of POST data (single or last stream).</span></div>
<div class="line"><span class="comment">//            - 5 = the same as 4, but with more data to follow.</span></div>
<div class="line"><span class="keywordtype">void</span> <a class="code" href="group__net__http_func.html#gad489f3562d1482e32ffa11f8045333cb">cgi_process_data</a> (uint8_t code, <span class="keyword">const</span> <span class="keywordtype">char</span> *data, uint32_t len) {</div>
<div class="line">  <span class="keywordtype">char</span> var[40];</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">switch</span> (code) {</div>
<div class="line">    <span class="keywordflow">case</span> 0:</div>
<div class="line">      <span class="comment">// URL encoded form data received</span></div>
<div class="line">      <span class="keywordflow">do</span> {</div>
<div class="line">        <span class="comment">// Parse all parameters</span></div>
<div class="line">        data = <a class="code" href="group__net__http_func.html#ga6f2f9fb059e4d34ee12a93582bfd7ed3">http_get_env_var</a> (data, var, <span class="keyword">sizeof</span> (var));</div>
<div class="line">        <span class="keywordflow">if</span> (var[0] != 0) {</div>
<div class="line">          <span class="comment">// First character is non-null, string exists</span></div>
<div class="line">          <span class="comment">/* Example</span></div>
<div class="line"><span class="comment">          if (strcmp (var, &quot;led0=on&quot;) == 0) {</span></div>
<div class="line"><span class="comment">            // ... Switch LED 0 on</span></div>
<div class="line"><span class="comment">          }</span></div>
<div class="line"><span class="comment">          */</span></div>
<div class="line">        }</div>
<div class="line">      } <span class="keywordflow">while</span> (data);</div>
<div class="line">      <span class="keywordflow">break</span>;</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">case</span> 1:</div>
<div class="line">      <span class="comment">// Filename for file upload received</span></div>
<div class="line">      <span class="comment">/* Example</span></div>
<div class="line"><span class="comment">      if (data[0] != 0) {</span></div>
<div class="line"><span class="comment">        // Open a file for writing</span></div>
<div class="line"><span class="comment">        file = fopen (var, &quot;w&quot;);</span></div>
<div class="line"><span class="comment">      }</span></div>
<div class="line"><span class="comment">      */</span></div>
<div class="line">      <span class="keywordflow">break</span>;</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">case</span> 2:</div>
<div class="line">      <span class="comment">// File content data received</span></div>
<div class="line">      <span class="comment">/* Example</span></div>
<div class="line"><span class="comment">      if (file != NULL) {</span></div>
<div class="line"><span class="comment">        // Write data to a file</span></div>
<div class="line"><span class="comment">        fwrite (data, 1, len, file);</span></div>
<div class="line"><span class="comment">      }</span></div>
<div class="line"><span class="comment">      */</span></div>
<div class="line">      <span class="keywordflow">break</span>;</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">case</span> 3:</div>
<div class="line">      <span class="comment">// File upload finished</span></div>
<div class="line">      <span class="comment">/* Example</span></div>
<div class="line"><span class="comment">      if (file != NULL) {</span></div>
<div class="line"><span class="comment">        // Close a file</span></div>
<div class="line"><span class="comment">        fclose (file);</span></div>
<div class="line"><span class="comment">      }</span></div>
<div class="line"><span class="comment">      */</span></div>
<div class="line">      <span class="keywordflow">break</span>;</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">case</span> 4:</div>
<div class="line">      <span class="comment">// Other content type data, last packet</span></div>
<div class="line">      <span class="comment">/* Example</span></div>
<div class="line"><span class="comment">      if (strcmp (http_get_content_type(), &quot;text/xml; charset=utf-8&quot; == 0) {</span></div>
<div class="line"><span class="comment">        // Content type xml, utf-8 encoding</span></div>
<div class="line"><span class="comment">         ...</span></div>
<div class="line"><span class="comment">      }</span></div>
<div class="line"><span class="comment">      */</span></div>
<div class="line">      <span class="keywordflow">break</span>;</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">case</span> 5:</div>
<div class="line">      <span class="comment">// Other content type data, more to follow</span></div>
<div class="line">      <span class="comment">// ... Process data</span></div>
<div class="line">      <span class="keywordflow">break</span>;</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">default</span>:</div>
<div class="line">      <span class="comment">// Ignore all other codes</span></div>
<div class="line">      <span class="keywordflow">break</span>;</div>
<div class="line">  }</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
</div>
<a class="anchor" id="ga344e2edc2397fa27fd78354c27312bcc"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void cgi_process_query </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>qstr</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Process query string received by GET request. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">qstr</td><td>pointer to the query string. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>none.</dd></dl>
<p>The function <b>cgi_process_query</b> processes the environmental variable QUERY_STRING that is returned by the GET method of the <a class="el" href="using_http_server.html#ws_script_langugage">CGI</a> form. The HTTP server calls this function when a user clicks the SUBMIT button on the input form.</p>
<p>The argument <em>qstr</em> points to the QUERY_STRING that is returned by the GET method. The query string is terminated by a space character.</p>
<p>The function is in the <b>HTTP_Server_CGI.c</b> module. </p>
<dl class="section note"><dt>Note</dt><dd><ul>
<li>The HTTP server calls the function only if the input form (HTML source) was created with attribute METHOD=GET. For example: <div class="fragment"><div class="line">&lt;FORM ACTION=index.htm METHOD=GET NAME=CGI&gt;</div>
<div class="line">..</div>
<div class="line">&lt;/FORM&gt;</div>
</div><!-- fragment --></li>
</ul>
</dd></dl>
<p><b>Code Example</b> </p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;stdio.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;string.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="rl__net_8h.html">rl_net.h</a>&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// Process query string received by GET request.</span></div>
<div class="line"><span class="keywordtype">void</span> <a class="code" href="group__net__http_func.html#ga344e2edc2397fa27fd78354c27312bcc">cgi_process_query</a> (<span class="keyword">const</span> <span class="keywordtype">char</span> *qstr) {</div>
<div class="line">  <span class="keywordtype">char</span> var[40];</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">do</span> {</div>
<div class="line">    <span class="comment">// Loop through all the parameters</span></div>
<div class="line">    qstr = <a class="code" href="group__net__http_func.html#ga6f2f9fb059e4d34ee12a93582bfd7ed3">http_get_env_var</a> (qstr, var, <span class="keyword">sizeof</span> (var));</div>
<div class="line">    <span class="comment">// Check return string, &#39;qstr&#39; now points to the next parameter</span></div>
<div class="line">    <span class="keywordflow">if</span> (var[0] != 0) {</div>
<div class="line">      <span class="comment">// First character is non-null, string exists</span></div>
<div class="line"></div>
<div class="line">      <span class="comment">/* Example of a parameter &quot;ip=192.168.0.100&quot;</span></div>
<div class="line"><span class="comment">      if (strncmp (var, &quot;ip=&quot;, 3) == 0) {</span></div>
<div class="line"><span class="comment">        int s[4];</span></div>
<div class="line"><span class="comment">        // Read parameter IP address submitted by the browser</span></div>
<div class="line"><span class="comment">        sscanf (&amp;var[3], &quot;%d.%d.%d.%d&quot;,&amp;s[0],&amp;s[1],&amp;s[2],&amp;s[3]);</span></div>
<div class="line"><span class="comment">         ...</span></div>
<div class="line"><span class="comment">      }</span></div>
<div class="line"><span class="comment">      */</span></div>
<div class="line">    }</div>
<div class="line">  } <span class="keywordflow">while</span> (qstr);</div>
<div class="line">}</div>
</div><!-- fragment --><p>Process query string received by GET request. </p>

</div>
</div>
<a class="anchor" id="ga977b2d34678313ddbc047fd4f5b2e55b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint32_t cgi_script </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>env</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>buflen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t *&#160;</td>
          <td class="paramname"><em>pcgi</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Generate dynamic web data from a script line. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">env</td><td>environment string. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">buf</td><td>output data buffer. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">buflen</td><td>size of output buffer (from 536 to 1460 bytes). </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">pcgi</td><td>pointer to a session's local buffer of 4 bytes.<ul>
<li>1st call = set to 0,</li>
<li>2nd call = not altered by the system,</li>
<li>3rd call = not altered by the system, etc. </li>
</ul>
</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>number of bytes written to output buffer.<ul>
<li>result len | (1U&lt;&lt;31) = repeat flag, the system calls this function again for the same script line.</li>
<li>result len | (1U&lt;&lt;30) = force transmit flag, the system transmits current packet immediately.</li>
</ul>
</dd></dl>
<p>The function <b>cgi_script</b> is what the <a class="el" href="using_http_server.html#ws_script_langugage">script</a> interpreter calls when interpreting the script to output the dynamic part of the HTTP response. The script interpreter calls <b>cgi_script</b> for each line in the script that begins with the command c. You must customize the <b>cgi_script</b> function so that it can understand and use the input string from the script.</p>
<p>The argument <em>env</em> is a pointer to the input string to create the dynamic response. It is the same string of bytes that is specified in the CGI script code using the c command.</p>
<p>The argument <em>buf</em> is a pointer to the output buffer where the <b>cgi_script</b> function must write the HTTP response.</p>
<p>The argument <em>buflen</em> specifies the length of the output buffer in bytes.</p>
<p>The argument <em>pcgi</em> is a pointer to a variable that never gets altered by the HTTP Server. Hence, you can use it to store parameters for successive calls of the <b>cgi_script</b> function. You might use this to store:</p>
<ul>
<li>loop counters</li>
<li>number of sent bytes</li>
<li>pointer to a local status buffer.</li>
</ul>
<p>The <b>cgi_script</b> function is in the <b>HTTP_Server_CGI.c</b> module.</p>
<dl class="section note"><dt>Note</dt><dd><ul>
<li>The <b>cgi_script</b> function is used by the <a class="el" href="using_http_server.html#ws_script_langugage">script interpreter</a>.</li>
<li>The contents written into the output buffer by the <b>cgi_script</b> function must be HTML code.</li>
<li><em>c</em> is a command that is available in the scripting language of the Network Component.</li>
<li>The length of the output buffer (<em>buflen</em>) might vary, because the length is determined by the TCP socket Maximum Segment Size (MSS) negotiation. The buffer length is normally around 1400 bytes for local LAN. But this can be reduced to 500 bytes or less. It also varies because the HTTP Server tries to optimize the number of generated TCP packets. It calls this function again to use the complete available buffer. It stops when there are only 240 or less bytes free in the buffer. This causes the packet to be generated and transmitted. If you want to force the HTTP Server to transmit the packet, you need to <code>or</code> the return value from this function with 1U&lt;&lt;30.</li>
<li>If <b>cgi_script</b> writes more bytes than <em>buflen</em> into the output buffer, a system crash from a corruption of the memory link pointers is highly likely.</li>
<li>The input string <em>env</em> might contain single-character subcommands to tell the <b>cgi_script</b> function how to process the script line correctly. There are no rules for these subcommands, so you can create and use your own commands.</li>
<li>The argument <em>pcgi</em> is private to each HTTP Session. The HTTP Server clears the data in the pcgi pointer to 0, before <b>cgi_script</b> is called for the first time in each session.</li>
<li><b>cgi_script</b> must update the contents in <em>pcgi</em> for each call. You can use the 4 bytes in <em>pcgi</em> to store data in any format.</li>
</ul>
</dd></dl>
<p><b>Code Example</b> </p>
<div class="fragment"><div class="line"><span class="comment">// Generate dynamic web data from a script line.</span></div>
<div class="line">uint32_t <a class="code" href="group__net__http_func.html#ga977b2d34678313ddbc047fd4f5b2e55b">cgi_script</a> (<span class="keyword">const</span> <span class="keywordtype">char</span> *env, <span class="keywordtype">char</span> *buf, uint32_t buflen, uint32_t *pcgi) {</div>
<div class="line">  uint32_t len = 0;</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Analyse a &#39;c&#39; script line starting position 2</span></div>
<div class="line">  <span class="comment">// c a i &lt;td&gt;&lt;input type=text name=ip value=&quot;%d.%d.%d.%d&quot; size=18 maxlength=18&gt;&lt;/td&gt;</span></div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">switch</span> (env[0]) {</div>
<div class="line">    <span class="keywordflow">case</span> <span class="charliteral">&#39;a&#39;</span> :</div>
<div class="line">      <span class="keywordflow">switch</span> (env[2]) {</div>
<div class="line">        <span class="keywordflow">case</span> <span class="charliteral">&#39;i&#39;</span>:</div>
<div class="line">          <span class="comment">// Write the local IP address</span></div>
<div class="line">          len = sprintf (buf, &amp;env[4], IpAddr[0], IpAddr[1], IpAddr[2], IpAddr[3]);</div>
<div class="line">          <span class="keywordflow">break</span>;</div>
<div class="line">          ...</div>
<div class="line">      }</div>
<div class="line">      <span class="keywordflow">break</span>;</div>
<div class="line">  }</div>
<div class="line">  <span class="keywordflow">return</span> (len);</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
</div>
<a class="anchor" id="ga092702be389b4b1aa5dff5d00b2a4841"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char * cgx_content_type </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Override default Content-Type for CGX script files. </p>
<dl class="section return"><dt>Returns</dt><dd>pointer to user defined Content-Type.</dd></dl>
<p>The function <b>cgx_content_type</b> allows you to change the Content-Type html header in the response to the web service application requests. The function returns a pointer to the new Content-Type html header. You can use this function to override the default content type header from the Network Component library. This content type header is used in cgx script responses.</p>
<p>The default content type header in cgx script response is: </p>
<div class="fragment"><div class="line">Content-Type: text/xml\r\n</div>
</div><!-- fragment --><p> This header is used if the <b>cgx_content_type</b> function does not exist in the project or if it returns a NULL pointer.</p>
<p>The <b>cgx_content_type</b> function is in the <b>HTTP_Server_CGI.c</b> module. The prototype is defined in <a class="el" href="rl__net__lib_8h.html">rl_net_lib.h</a>.</p>
<dl class="section note"><dt>Note</dt><dd>This function is optional. If missing, or returning NULL, a default "text/xml" content type is used.</dd></dl>
<p><b>Code Example</b> </p>
<div class="fragment"><div class="line"><span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="group__net__http_func.html#ga092702be389b4b1aa5dff5d00b2a4841">cgx_content_type</a> (<span class="keywordtype">void</span>) {</div>
<div class="line">  <span class="comment">// Example</span></div>
<div class="line">  <span class="keywordflow">if</span>(trueCondition) {</div>
<div class="line">    <span class="keywordflow">return</span> (<span class="stringliteral">&quot;text/xml; charset=utf-8&quot;</span>);</div>
<div class="line">  }</div>
<div class="line">  <span class="keywordflow">return</span> (NULL);</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
</div>
<a class="anchor" id="ga5a4b5fea162e7fecf7de6a9672ceeb3f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool http_accept_client </td>
          <td>(</td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>ip_addr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>port</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Accept or deny connection from remote HTTP client. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ip_addr</td><td>IP address of the remote HTTP client. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">port</td><td>port number of the remote HTTP client. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><ul>
<li>true = Connection from the remote client is allowed.</li>
<li>false = Connection is denied.</li>
</ul>
</dd></dl>
<p>The function <b>http_accept_client</b> checks if a connection from a remote client is allowed or not. This enables remote client filtering. You can selectively decide which clients are allowed to connect to the web server.</p>
<p>The argument <em>ip_addr</em> points to a buffer containing the four octets that make up the IP address of the remote machine.</p>
<p>The argument <em>port</em> specifies the port on the remote machine.</p>
<p>The function is in the <b>HTTP_Server_Access.c</b> module. </p>
<dl class="section note"><dt>Note</dt><dd>This function is optional. If it does not exist in the project, the library default function is used. The library default function accepts all remote clients.</dd></dl>
<p><b>Code Example</b> </p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="rl__net_8h.html">rl_net.h</a>&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// Accept or deny connection from remote HTTP client.</span></div>
<div class="line"><span class="comment">// If this function is missing, all remote clients are accepted.</span></div>
<div class="line"><span class="keywordtype">bool</span> <a class="code" href="group__net__http_func.html#ga5a4b5fea162e7fecf7de6a9672ceeb3f">http_accept_client</a> (<span class="keyword">const</span> uint8_t *ip_addr, uint16_t port) {</div>
<div class="line">  <span class="comment">/* Example</span></div>
<div class="line"><span class="comment">  if (ip_addr[0] == 192  &amp;&amp;</span></div>
<div class="line"><span class="comment">      ip_addr[1] == 168  &amp;&amp;</span></div>
<div class="line"><span class="comment">      ip_addr[2] == 0    &amp;&amp;</span></div>
<div class="line"><span class="comment">      ip_addr[3] == 1) {</span></div>
<div class="line"><span class="comment">    // Accept connection.</span></div>
<div class="line"><span class="comment">    return (true);</span></div>
<div class="line"><span class="comment">  }</span></div>
<div class="line"><span class="comment">  // Deny connection.</span></div>
<div class="line"><span class="comment">  return (false);</span></div>
<div class="line"><span class="comment">  */</span></div>
<div class="line">  <span class="keywordflow">return</span> (<span class="keyword">true</span>);</div>
<div class="line">}</div>
</div><!-- fragment --><p> Accept or deny connection from remote HTTP client. </p>

</div>
</div>
<a class="anchor" id="ga35b6f62f47735bb08ba5261522b87b9e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t http_check_account </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>username</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>password</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Check if an user account exist in the user database. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">username</td><td>pointer to username. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">password</td><td>pointer to password. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>status information:<ul>
<li>User identification number or</li>
<li>0 if the user is not existing.</li>
</ul>
</dd></dl>
<p>The function <b>http_check_account</b> checks if a user account exist in the user database for the provided credentials. It is called from the Network Component's Web server to check if the user with provided credentials is allowed to access the web pages or not.</p>
<p>The argument <em>username</em> points to a 0-terminated string representing the user name that was typed in from the browser.</p>
<p>The argument <em>password</em> points to a 0-terminated string representing the password.</p>
<p>The function is in the <b>HTTP_Server_Multiuser.c</b> module.</p>
<dl class="section note"><dt>Note</dt><dd>This function is optional. For single user HTTP authentication or when the HTTP authentication is disabled in the configuration, this function is not required.</dd></dl>
<p><b>Code Example</b> </p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;string.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="rl__net_8h.html">rl_net.h</a>&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// Check if an user account exist in the user database.</span></div>
<div class="line">uint8_t <a class="code" href="group__net__http_func.html#ga35b6f62f47735bb08ba5261522b87b9e">http_check_account</a> (<span class="keyword">const</span> <span class="keywordtype">char</span> *username, <span class="keyword">const</span> <span class="keywordtype">char</span> *password) {</div>
<div class="line">  <span class="comment">/* Example</span></div>
<div class="line"><span class="comment">  if ((strcmp (username, &quot;guest&quot;) == 0) &amp;&amp; (strcmp (password, &quot;guest&quot;) == 0)) {</span></div>
<div class="line"><span class="comment">    // Accept guest account</span></div>
<div class="line"><span class="comment">    return (1);</span></div>
<div class="line"><span class="comment">  }</span></div>
<div class="line"><span class="comment">  */</span></div>
<div class="line">  <span class="keywordflow">return</span> (0);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Check if remote user is allowed to access a file on HTTP server.</span></div>
<div class="line"><span class="keywordtype">bool</span> <a class="code" href="group__net__http_func.html#ga34d2f0e562a5e226704ac38ed14a01e7">http_file_access</a> (uint8_t user_id, <span class="keyword">const</span> <span class="keywordtype">char</span> *fname) {</div>
<div class="line">  <span class="comment">/* Example</span></div>
<div class="line"><span class="comment">  if (user_id == 1) {</span></div>
<div class="line"><span class="comment">    if (strcmp (fname, &quot;system.cgi&quot;) == 0) {</span></div>
<div class="line"><span class="comment">      // User &quot;guest&quot; is not allowed to see &quot;system.cgi&quot;</span></div>
<div class="line"><span class="comment">      return (false);</span></div>
<div class="line"><span class="comment">    }</span></div>
<div class="line"><span class="comment">  }</span></div>
<div class="line"><span class="comment">  */</span></div>
<div class="line">  <span class="keywordflow">return</span> (<span class="keyword">true</span>);</div>
<div class="line">}</div>
</div><!-- fragment --><p> Check if an user account exist in the user database. </p>

</div>
</div>
<a class="anchor" id="ga3640efd81eebd825d238d153407d52a2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char * http_encoding </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Override default character encoding in html documents. </p>
<dl class="section return"><dt>Returns</dt><dd>pointer to user defined character set type.</dd></dl>
<p>The function <b>http_encoding</b> overrides the default character encoding in a web browser. If this function is implemented and returns a non-NULL pointer, the web server adds a character encoding HTTP header. The browser then uses this information to correctly decode the character set.</p>
<p>If this function is not existing (or returns NULL), then the ‘charset’ parameter is not generated in web server's response. The browser then uses the default character encoding. This might cause troubles in displaying web pages that are encoded in different character sets. Example: an English user might not see the umlauts characters on German web pages.</p>
<dl class="section note"><dt>Note</dt><dd>This function is optional.</dd></dl>
<p><b>Code Example</b> </p>
<div class="fragment"><div class="line"><span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="group__net__http_func.html#ga3640efd81eebd825d238d153407d52a2">http_encoding</a> (<span class="keywordtype">void</span>) {</div>
<div class="line">  <span class="keywordflow">return</span> (<span class="stringliteral">&quot;iso-8859-1&quot;</span>);</div>
<div class="line">}</div>
</div><!-- fragment --><p>The example above will instruct the web server to generate the following HTTP header: </p>
<div class="fragment"><div class="line">Content-type: text/html; charset=iso-8859-1</div>
</div><!-- fragment --> 
</div>
</div>
<a class="anchor" id="ga34d2f0e562a5e226704ac38ed14a01e7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool http_file_access </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>user_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>fname</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Check if remote user is allowed to access a file on HTTP server. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">user_id</td><td>user identification number. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">fname</td><td>name of a file to access. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><ul>
<li>true = File access is allowed.</li>
<li>false = File access is denied.</li>
</ul>
</dd></dl>
<p>The function <b>http_file_access</b> checks if a file access is allowed for a specified user. This enables access protection of sensitive web pages. Protected web pages will not be displayed for unprivileged users. Instead, the Web server shows Error page 403 - Forbidden.</p>
<p>The argument <em>user_id</em> is an user identification number as returned by <a class="el" href="group__net__http_func.html#ga35b6f62f47735bb08ba5261522b87b9e">http_check_account</a>. It identifies the user who is trying to access the specified file.</p>
<p>The argument <em>fname</em> points to a buffer containing the file name of a file, which the user is trying to access. The file name is a 0-terminated string.</p>
<p>The function is in the <b>HTTP_Server_Multiuser.c</b> module.</p>
<dl class="section note"><dt>Note</dt><dd>This function is optional. If the HTTP resource access restriction is not used, this function is not required.</dd></dl>
<p><b>Code Example</b> </p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;string.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="rl__net_8h.html">rl_net.h</a>&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// Check if an user account exist in the user database.</span></div>
<div class="line">uint8_t <a class="code" href="group__net__http_func.html#ga35b6f62f47735bb08ba5261522b87b9e">http_check_account</a> (<span class="keyword">const</span> <span class="keywordtype">char</span> *username, <span class="keyword">const</span> <span class="keywordtype">char</span> *password) {</div>
<div class="line">  <span class="comment">/* Example</span></div>
<div class="line"><span class="comment">  if ((strcmp (username, &quot;guest&quot;) == 0) &amp;&amp; (strcmp (password, &quot;guest&quot;) == 0)) {</span></div>
<div class="line"><span class="comment">    // Accept guest account</span></div>
<div class="line"><span class="comment">    return (1);</span></div>
<div class="line"><span class="comment">  }</span></div>
<div class="line"><span class="comment">  */</span></div>
<div class="line">  <span class="keywordflow">return</span> (0);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Check if remote user is allowed to access a file on HTTP server.</span></div>
<div class="line"><span class="keywordtype">bool</span> <a class="code" href="group__net__http_func.html#ga34d2f0e562a5e226704ac38ed14a01e7">http_file_access</a> (uint8_t user_id, <span class="keyword">const</span> <span class="keywordtype">char</span> *fname) {</div>
<div class="line">  <span class="comment">/* Example</span></div>
<div class="line"><span class="comment">  if (user_id == 1) {</span></div>
<div class="line"><span class="comment">    if (strcmp (fname, &quot;system.cgi&quot;) == 0) {</span></div>
<div class="line"><span class="comment">      // User &quot;guest&quot; is not allowed to see &quot;system.cgi&quot;</span></div>
<div class="line"><span class="comment">      return (false);</span></div>
<div class="line"><span class="comment">    }</span></div>
<div class="line"><span class="comment">  }</span></div>
<div class="line"><span class="comment">  */</span></div>
<div class="line">  <span class="keywordflow">return</span> (<span class="keyword">true</span>);</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga6f2f9fb059e4d34ee12a93582bfd7ed3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char * http_get_env_var </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>env</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>ansi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>maxlen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Process environment variables and convert to ANSI format. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">env</td><td>pointer to environment variables. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">ansi</td><td>output buffer to write converted variable to. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">maxlen</td><td>maximum length of environment variable. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>status information:<ul>
<li>pointer to the remaining environment variables to process or</li>
<li>NULL if there are no more environment variables to process.</li>
</ul>
</dd></dl>
<p>The function <b>http_get_env_var</b> processes the string <em>env</em>, which contains the environment variables, and identifies where the first variable ends. The function obtains and stores the first variable and its value in the buffer pointed by <em>ansi</em>, in ANSI format.</p>
<p>The argument <em>maxlen</em> specifies the maximum length that can be stored in the <em>ansi</em> buffer. If the decoded environment variable value is longer than this limit, then the function truncates it to <em>maxlen</em> to fit it into the buffer.</p>
<dl class="section note"><dt>Note</dt><dd><ul>
<li>The function can process environment variables from the GET and POST methods.</li>
<li>You can call this function from the <b>HTTP_Server_CGI.c</b> module.</li>
<li>The web browser uses environment variables to return user-entered information that is requested in the HTTP input form.</li>
</ul>
</dd></dl>
<p><b>Code Example</b> </p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;stdio.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;string.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="rl__net_8h.html">rl_net.h</a>&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// Process query string received by GET request.</span></div>
<div class="line"><span class="keywordtype">void</span> <a class="code" href="group__net__http_func.html#ga344e2edc2397fa27fd78354c27312bcc">cgi_process_query</a> (<span class="keyword">const</span> <span class="keywordtype">char</span> *qstr) {</div>
<div class="line">  <span class="keywordtype">char</span> var[40];</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">do</span> {</div>
<div class="line">    <span class="comment">// Loop through all the parameters</span></div>
<div class="line">    qstr = <a class="code" href="group__net__http_func.html#ga6f2f9fb059e4d34ee12a93582bfd7ed3">http_get_env_var</a> (qstr, var, <span class="keyword">sizeof</span> (var));</div>
<div class="line">    <span class="comment">// Check return string, &#39;qstr&#39; now points to the next parameter</span></div>
<div class="line">    <span class="keywordflow">if</span> (var[0] != 0) {</div>
<div class="line">      <span class="comment">// First character is non-null, string exists</span></div>
<div class="line"></div>
<div class="line">      <span class="comment">// Example of a parameter &quot;ip=192.168.0.100&quot;</span></div>
<div class="line">      <span class="keywordflow">if</span> (strncmp (var, <span class="stringliteral">&quot;ip=&quot;</span>, 3) == 0) {</div>
<div class="line">        <span class="keywordtype">int</span> s[4];</div>
<div class="line">        <span class="comment">// Read parameter IP address submitted by the browser</span></div>
<div class="line">        sscanf (&amp;var[3], <span class="stringliteral">&quot;%d.%d.%d.%d&quot;</span>,&amp;s[0],&amp;s[1],&amp;s[2],&amp;s[3]);</div>
<div class="line">         ...</div>
<div class="line">      }</div>
<div class="line">    }</div>
<div class="line">  } <span class="keywordflow">while</span> (qstr);</div>
<div class="line">}</div>
</div><!-- fragment --> 
<p>Referenced by <a class="el" href="group__net__http_func.html#gad489f3562d1482e32ffa11f8045333cb">cgi_process_data()</a>, and <a class="el" href="group__net__http_func.html#ga344e2edc2397fa27fd78354c27312bcc">cgi_process_query()</a>.</p>

</div>
</div>
<a class="anchor" id="ga8979e7080cfe548f33ec5a377ce5cfd8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t http_get_user_id </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Retrieve the user identification. </p>
<dl class="section return"><dt>Returns</dt><dd>user identification number (0 = system administrator).</dd></dl>
<p>The function <b>http_get_user_id</b> retrieves the user identification number when the web pages are protected with user authentication. It can be used to generate a web page, whose content is based on the connected user. This function is normally called from the cgi_script function.</p>
<p>The <b>http_get_user_id</b> is a system function that is in the Network Component library.</p>
<dl class="section note"><dt>Note</dt><dd>This function returns a value of 0 for system administrator account.</dd></dl>
<p><b>Code Example</b> </p>
<div class="fragment"><div class="line">uint16_t <a class="code" href="group__net__http_func.html#ga977b2d34678313ddbc047fd4f5b2e55b">cgi_script</a> (<span class="keyword">const</span> <span class="keywordtype">char</span> *env, <span class="keywordtype">char</span> *buf, uint16_t buflen, uint32_t *pcgi) {</div>
<div class="line">  uint8_t uid;</div>
<div class="line">  ..</div>
<div class="line">    <span class="keywordflow">case</span> <span class="charliteral">&#39;d&#39;</span>:</div>
<div class="line">      <span class="comment">// System password - file &#39;system.cgi&#39; </span></div>
<div class="line">      <span class="keywordflow">switch</span> (env[2]) {</div>
<div class="line">        <span class="keywordflow">case</span> <span class="charliteral">&#39;0&#39;</span>:</div>
<div class="line">          <span class="comment">// Display the user name on web page. </span></div>
<div class="line">          uid = <a class="code" href="group__net__http_func.html#ga8979e7080cfe548f33ec5a377ce5cfd8">http_get_user_id</a> ();</div>
<div class="line">          len = sprintf((<span class="keywordtype">char</span> *)buf,(<span class="keyword">const</span> <span class="keywordtype">char</span> *)&amp;env[4],</div>
<div class="line">                        (uid == 0) ? <span class="stringliteral">&quot;admin&quot;</span> : users[uid-1]);</div>
<div class="line">          <span class="keywordflow">break</span>;</div>
<div class="line">        <span class="keywordflow">case</span> <span class="charliteral">&#39;1&#39;</span>:</div>
<div class="line">           ..</div>
<div class="line">          <span class="keywordflow">break</span>;</div>
<div class="line">      }</div>
<div class="line">      <span class="keywordflow">break</span>;</div>
<div class="line">   ..</div>
<div class="line">}  </div>
</div><!-- fragment --> 
</div>
</div>
<a class="anchor" id="ga7f28c5595361d3d16decb4f5e0b6cd8e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void http_server_fclose </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>file</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Close a file previously open in HTTP server. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">file</td><td>pointer to the file to close. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>none.</dd></dl>
<p>The function <b>http_server_fclose</b> closes the file identified by the <em>file</em> stream pointer in the function argument.</p>
<p>The function interfaces to the File System Component and will be called by the Network Component automatically. If another file system will be used, refer to the reference implementation in the <b>HTTP_Server_FS.c</b> module. </p>

</div>
</div>
<a class="anchor" id="ga44887ab206ed6b707fbc526f2e09048d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char * http_server_fgets </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Read a string from a file in HTTP server. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">file</td><td>pointer to the file to read from. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">buf</td><td>output buffer to write data to. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">size</td><td>size of output buffer. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>status information:<ul>
<li>Pointer to string on success</li>
<li>NULL in case of an error.</li>
</ul>
</dd></dl>
<p>The function <b>http_server_fgets</b> reads up to <em>size</em> bytes from the file identified by the <em>file</em> stream pointer in the function argument.</p>
<p>The argument <em>buf</em> is a pointer to the buffer which stores the data.</p>
<p>The function interfaces to the File System Component and will be called by the Network Component automatically. If another file system will be used, refer to the reference implementation in the <b>HTTP_Server_FS.c</b> module.</p>
<dl class="section note"><dt>Note</dt><dd>The function is used by the <a class="el" href="using_http_server.html#ws_script_langugage">script interpreter</a>. </dd></dl>

</div>
</div>
<a class="anchor" id="gae141878f0b5761ae1678e8095050510f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void * http_server_fopen </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>fname</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Open a file for reading in HTTP server. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">fname</td><td>name of the file to open. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>status information:<ul>
<li>Pointer to an open file or</li>
<li>NULL in case of an error.</li>
</ul>
</dd></dl>
<p>The function <b>http_server_fopen</b> opens a file for reading.</p>
<p>The argument <em>fname</em> specifies the name of the file to open. If the file does not exist, the function fails and returns <span class="XML-Token">NULL</span>.</p>
<p>The argument <em>fname</em> is percent-encoded. This means that all reserved characters in a file name are escaped.</p>
<p>The function interfaces to the File System Component and will be called by the Network Component automatically. If another file system will be used, refer to the reference implementation in the <b>HTTP_Server_FS.c</b> module.</p>
<p>Open a file for reading in HTTP server. </p>

</div>
</div>
<a class="anchor" id="ga4b6205c88569381be8c810b4e3aa2226"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint32_t http_server_fread </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Read block of data from a file in HTTP server. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">file</td><td>pointer to the file to read from. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">buf</td><td>block of memory to write data to. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">len</td><td>length of data to read in bytes. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>number of bytes successfully read.</dd></dl>
<p>The function <b>http_server_fread</b> reads <em>len</em> bytes from the file identified by the <em>file</em> stream pointer in the function argument.</p>
<p>The argument <em>buf</em> is a pointer to the buffer where the function stores the read data.</p>
<p>The function interfaces to the File System Component and will be called by the Network Component automatically. If another file system will be used, refer to the reference implementation in the <b>HTTP_Server_FS.c</b> module.</p>
<dl class="section note"><dt>Note</dt><dd>The function must read <em>len</em> bytes. The Web Server stops reading and closes the file if the return value is less than <em>len</em> bytes. </dd></dl>

</div>
</div>
<a class="anchor" id="ga7d1f7422e7e08679c48ce944db49647a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint32_t http_server_ftime </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>fname</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Retrieve last modification time of a file. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">fname</td><td>name of the file. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>last modification time in UTC format.</dd></dl>
<p>The function <b>http_server_ftime</b> reads the time when the file identified by the <em>fname</em> was last modified.</p>
<p>The function interfaces to the File System Component and will be called by the Network Component automatically. If another file system will be used, refer to the reference implementation in the <b>HTTP_Server_FS.c</b> module. </p>

</div>
</div>
<a class="anchor" id="ga8afdc0440fb17b82d62e7e788d29d4ad"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__status__error__codes__net.html#ga5675a3b88ee02986ae15ae3bb8135551">netStatus</a> http_server_get_client </td>
          <td>(</td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>ip_addr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>mac_addr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get IP and MAC address of connected remote machine. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">ip_addr</td><td>pointer to IP address. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">mac_addr</td><td>pointer to MAC address. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>status code that indicates the execution status of the function as defined with <a class="el" href="rl__net_8h.html#a5675a3b88ee02986ae15ae3bb8135551">netStatus</a>.</dd></dl>
<p>The function <b>http_server_get_client</b> obtains information about the remote machine and records the IP address and MAC address in memory.</p>
<p>The argument <em>ip_addr</em> is the remote machine IP address.</p>
<p>The argument <em>mac_addr</em> is the remote machine MAC address.</p>
<dl class="section note"><dt>Note</dt><dd><ul>
<li>You can use the IP address or MAC address information to restrict which remote machines are allowed to perform system changes.</li>
<li>For PPP and SLIP links, the function records 00-00-00-00-00-00 as the MAC address.</li>
</ul>
</dd></dl>
<p><b>Code Example</b> </p>
<div class="fragment"><div class="line"><span class="comment">//coming soon</span></div>
</div><!-- fragment --> 
</div>
</div>
<a class="anchor" id="ga940b475ffc39fc39ec692b536106dc47"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char * http_server_get_content_type </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get Content-Type HTML header, received in XML post request. </p>
<dl class="section return"><dt>Returns</dt><dd>pointer to content type header, a null-terminated string.</dd></dl>
<p>The function <b>http_server_get_content_type</b> returns a pointer to the Content-Type html header, which was received with a XML or any other type POST request. You can use this function to check for the content type, which was submitted by a web service application.</p>
<dl class="section note"><dt>Note</dt><dd>When a web service application sends a request to a web server, it specifies the Content-Type in the HTTP header that is sent to the web server. This information is processed by the Network Component and stored internally.</dd></dl>
<p><b>Code Example</b> </p>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> <a class="code" href="group__net__http_func.html#gad489f3562d1482e32ffa11f8045333cb">cgi_process_data</a> (uint8_t code, <span class="keyword">const</span> <span class="keywordtype">char</span> *data, uint32_t len) {</div>
<div class="line">  <span class="keywordtype">char</span> var[40];</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">switch</span> (code) {</div>
<div class="line">    ...</div>
<div class="line">    <span class="keywordflow">case</span> 4:</div>
<div class="line">      <span class="comment">// Other content type data, last packet</span></div>
<div class="line">      <span class="comment">// Example</span></div>
<div class="line">      <span class="keywordflow">if</span> (strcmp (http_get_content_type(), <span class="stringliteral">&quot;text/xml; charset=utf-8&quot;</span> == 0) {</div>
<div class="line">        <span class="comment">// Content type xml, utf-8 encoding</span></div>
<div class="line">         ...</div>
<div class="line">      }</div>
<div class="line">      <span class="keywordflow">break</span>;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">default</span>:</div>
<div class="line">      <span class="comment">// Ignore all other codes</span></div>
<div class="line">      <span class="keywordflow">break</span>;</div>
<div class="line">  }</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
</div>
<a class="anchor" id="ga9de72e43415a12fe5aff144921d0eb4f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char * http_server_get_lang </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Retrieve the preferred language setting from the browser. </p>
<dl class="section return"><dt>Returns</dt><dd>pointer to the language code, a null-terminated string.</dd></dl>
<p>The function <b>http_server_get_lang</b> retrieves the preferred language setting from the browser. You can use this information to implement automatic language selection for your embedded web pages.</p>
<dl class="section note"><dt>Note</dt><dd><ul>
<li>When a web browser requests a web page, it specifies the preferred language in the HTTP header that is sent to the web server. This information is processed by the Network Component and stored internally.</li>
<li>You can set the language preference in Internet Explorer by selecting <b>Tools -&gt; Internet Options -&gt; Languages</b>. In Mozilla Firefox, you can set the language preference by selecting <b>Options -&gt; Options -&gt; Content -&gt; Languages</b>.</li>
</ul>
</dd></dl>
<p><b>Code Example</b> </p>
<div class="fragment"><div class="line">uint32_t <a class="code" href="group__net__http_func.html#ga977b2d34678313ddbc047fd4f5b2e55b">cgi_script</a> (<span class="keyword">const</span> <span class="keywordtype">char</span> *env, <span class="keywordtype">char</span> *buf, uint32_t buflen, uint32_t *pcgi) {</div>
<div class="line">  uint32_t len = 0;</div>
<div class="line">  <span class="keywordtype">char</span> *lang;</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">switch</span> (env[0]) {</div>
<div class="line">     ..</div>
<div class="line">    <span class="keywordflow">case</span> <span class="charliteral">&#39;e&#39;</span>:</div>
<div class="line">      <span class="comment">// Browser Language - file &#39;language.cgi&#39; </span></div>
<div class="line">      lang = http_get_lang();</div>
<div class="line">      <span class="keywordflow">if</span> (strcmp (lang, <span class="stringliteral">&quot;en&quot;</span>) == 0) {</div>
<div class="line">        lang = <span class="stringliteral">&quot;English&quot;</span>;</div>
<div class="line">      }</div>
<div class="line">      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp (lang, <span class="stringliteral">&quot;en-us&quot;</span>) == 0) {</div>
<div class="line">        lang = <span class="stringliteral">&quot;English USA&quot;</span>;</div>
<div class="line">      }</div>
<div class="line">      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp (lang, <span class="stringliteral">&quot;de&quot;</span>) == 0) {</div>
<div class="line">        lang = <span class="stringliteral">&quot;German&quot;</span>;</div>
<div class="line">      }</div>
<div class="line">      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp (lang, <span class="stringliteral">&quot;de-at&quot;</span>) == 0) {</div>
<div class="line">        lang = <span class="stringliteral">&quot;German AT&quot;</span>;</div>
<div class="line">      }</div>
<div class="line">      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp (lang, <span class="stringliteral">&quot;fr&quot;</span>) == 0) {</div>
<div class="line">        lang = <span class="stringliteral">&quot;French&quot;</span>;</div>
<div class="line">      }</div>
<div class="line">      <span class="keywordflow">else</span> {</div>
<div class="line">        lang = <span class="stringliteral">&quot;Unknown&quot;</span>;</div>
<div class="line">      }</div>
<div class="line">      len = sprintf(buf,&amp;env[2],lang,http_get_lang());</div>
<div class="line">      <span class="keywordflow">break</span>;</div>
<div class="line">  }</div>
<div class="line">  <span class="keywordflow">return</span> (len);</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
</div>
<a class="anchor" id="gafe5c5a991a4d01baf11ef291a5c6ef6a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int32_t http_server_get_session </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get current session number of HTTP server. </p>
<dl class="section return"><dt>Returns</dt><dd>current session number.</dd></dl>
<p>The function <b>http_server_get_session</b> returns the current session number of the HTTP server running on the Network Component. The session number can be any value between 0 and HTTP_SERVER_NUM_SESSIONS, defined in <b>Net_Config_HTTP_Server.h</b>.</p>
<dl class="section note"><dt>Note</dt><dd>Storing the HTTP query string in a single global variable can result in the HTTP server sending the wrong reply to a client when several clients try to access a dynamic HTTP page at the same time. Hence, it is better to have a separate variable for each session, for example an array of query strings.</dd></dl>
<p><b>Code Example</b> </p>
<div class="fragment"><div class="line"><span class="comment">// Should be the same value as set in &#39;Net_Config_HTTP_Server.h&#39; file. </span></div>
<div class="line"><span class="preprocessor">#define HTTP_SERVER_NUM_SESSIONS 10</span></div>
<div class="line"><span class="preprocessor"></span> </div>
<div class="line">int32_t answer[HTTP_SERVER_NUM_SESSIONS];</div>
<div class="line"> </div>
<div class="line">uint32_t <a class="code" href="group__net__http_func.html#ga977b2d34678313ddbc047fd4f5b2e55b">cgi_script</a> (<span class="keyword">const</span> <span class="keywordtype">char</span> *env, <span class="keywordtype">char</span> *buf, uint32_t buflen, uint32_t *pcgi)</div>
<div class="line">  uint32_t len = 0;</div>
<div class="line">  int32_t http_session;</div>
<div class="line">  ..</div>
<div class="line">  http_session = <a class="code" href="group__net__http_func.html#gafe5c5a991a4d01baf11ef291a5c6ef6a">http_server_get_session</a> ();</div>
<div class="line">  len += sprintf (buf+len,<span class="stringliteral">&quot;Answer is: %d&quot;</span>,answer[http_session]);</div>
<div class="line">   ..</div>
<div class="line">  <span class="keywordflow">return</span> (len);</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
</div>
<a class="anchor" id="ga3915d89170929c7ca5a32d2fbfac5804"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint32_t http_utc_time </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>hr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>min</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>sec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>day</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>mon</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>year</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Convert generic time to UTC time format. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">hr</td><td>hours [0..23]. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">min</td><td>minutes [0..59]. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">sec</td><td>seconds [0..59]. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">day</td><td>day [1..31]. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">mon</td><td>month [1..12]. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">year</td><td>year [1980..2107]. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>time converted to UTC format.</dd></dl>
<p>The function <b>http_utc_time</b> converts the time arguments into a UTC time format.</p>
<p><b>Code Example</b> </p>
<div class="fragment"><div class="line"><span class="comment">// Retrieve last modification time of a file.</span></div>
<div class="line">uint32_t <a class="code" href="group__net__http_func.html#ga7d1f7422e7e08679c48ce944db49647a">http_server_ftime</a> (<span class="keyword">const</span> <span class="keywordtype">char</span> *fname) {</div>
<div class="line">  fsFileInfo *info;</div>
<div class="line">  uint32_t utc;</div>
<div class="line"> </div>
<div class="line">  info = (fsFileInfo *)<a class="code" href="group__net__internal__system__functions.html#ga52f2163878d5511e949b0d9b4b4f4a50">mem_alloc</a> (<span class="keyword">sizeof</span> (fsFileInfo));</div>
<div class="line">  info-&gt;fileID = 0;</div>
<div class="line">  utc = 0;</div>
<div class="line">  <span class="keywordflow">if</span> (ffind (fname, info) == fsOK) {</div>
<div class="line">    <span class="comment">// File found, convert creation time to UTC format.</span></div>
<div class="line">    utc = <a class="code" href="group__net__http_func.html#ga3915d89170929c7ca5a32d2fbfac5804">http_utc_time</a> (info-&gt;time.sec, info-&gt;time.min, info-&gt;time.hr,</div>
<div class="line">                         info-&gt;time.day, info-&gt;time.mon, info-&gt;time.year);</div>
<div class="line">  }</div>
<div class="line">  <a class="code" href="group__net__internal__system__functions.html#gaabe8a6ae9299fd005016461dd1566e4f">mem_free</a> ((<a class="code" href="group__net__internal__system__functions.html#struct_n_e_t___f_r_a_m_e">NET_FRAME</a> *)info);</div>
<div class="line">  <span class="keywordflow">return</span> (utc);</div>
<div class="line">}</div>
</div><!-- fragment --> 
<p>Referenced by <a class="el" href="group__net__http_func.html#ga7d1f7422e7e08679c48ce944db49647a">http_server_ftime()</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Tue May 25 2021 13:57:56 for Network Component by ARM Ltd. All rights reserved.
	<!--
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.6 
	-->
	</li>
  </ul>
</div>
</body>
</html>
